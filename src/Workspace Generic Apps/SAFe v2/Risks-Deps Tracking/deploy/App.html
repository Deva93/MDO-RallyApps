<!DOCTYPE html>
<html>
<head>
    <title>Risks and Deps Tracking</title>

    <script type="text/javascript" src="/apps/2.0rc3/sdk.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/q.js/1.0.1/q.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("IntelRallyApp",{alias:"widget.intelrallyapp",extend:"Rally.app.App",_TrainConfigPrefName:"intel-train-config",_projectFields:["ObjectID","Releases","Children","Parent","Name","TeamMembers"],_portfolioItemFields:["Name","ObjectID","FormattedID","c_TeamCommits","c_MoSCoW","Release","c_Risks","Project","PlannedEndDate","Parent","Children","PortfolioItemType","Ordinal"],_userStoryFields:["Name","ObjectID","Release","Project","PortfolioItem","PlannedEndDate","ActualEndDate","FormattedID","Predecessors","Successors","c_Dependencies","Iteration","PlanEstimate"],_releaseFields:["Name","ObjectID","ReleaseDate","ReleaseStartDate","Project","TeamMembers"],_loadScheduleStates:function(){var me=this,deferred=Q.defer();return Rally.data.ModelFactory.getModel({type:"UserStory",success:function(model){model.getField("ScheduleState").getAllowedValueStore().load({callback:function(records,operation,success){me.ScheduleStates=_.map(records,function(r){return r.data.StringValue}),deferred.resolve()}})}}),deferred.promise},_loadPortfolioItemStatesForEachType:function(){var me=this;return me.PortfolioItemTypeStates=[],Q.all(_.map(me.PortfolioItemTypes,function(portfolioType,ordinal){var store=Ext.create("Rally.data.wsapi.Store",{model:"State",autoLoad:!1,limit:1/0,disableMetaChangeEvent:!0,fetch:["Name","Enabled","OrderIndex"],filters:[{property:"TypeDef.Name",value:portfolioType},{property:"Enabled",value:!0}]});return me._reloadStore(store).then(function(store){me.PortfolioItemTypeStates[ordinal]=store.getRange()})}))},_loadPortfolioItemTypes:function(){var me=this,deferred=Q.defer(),store=Ext.create("Rally.data.wsapi.Store",{model:"TypeDefinition",autoLoad:!0,limit:1/0,disableMetaChangeEvent:!0,fetch:["Ordinal","Name"],filters:[{property:"Parent.Name",value:"Portfolio Item"},{property:"Creatable",value:!0}],listeners:{load:function(portfolioTypeStore){me.PortfolioItemTypes=_.map(_.sortBy(_.map(portfolioTypeStore.getRange(),function(item){return{Name:item.data.Name,Ordinal:item.data.Ordinal}}),function(item){return item.Ordinal}),function(item){return item.Name}),deferred.resolve()}}});return deferred.promise},_loadModels:function(){var me=this,promises=[],models={Project:"Project",UserStory:"HierarchicalRequirement",PortfolioItem:"PortfolioItem"};return _.each(me.PortfolioItemTypes,function(name){models[name]="PortfolioItem/"+name}),_.each(models,function(modelType,modelName){var deferred=Q.defer();Rally.data.WsapiModelFactory.getModel({type:modelType,success:function(loadedModel){me[modelName]=loadedModel,deferred.resolve()}}),promises.push(deferred.promise)}),Q.all(promises)},_loadTrainConfig:function(){var me=this,deferred=Q.defer();return Rally.data.PreferenceManager.load({workspace:me.getContext().getWorkspace()._ref,filterByName:me._TrainConfigPrefName,success:function(prefs){var workspaceConfigString=prefs[me._TrainConfigPrefName],trainConfig;try{trainConfig=JSON.parse(workspaceConfigString)}catch(e){trainConfig=[]}me.TrainConfig=trainConfig,deferred.resolve()},failure:deferred.reject}),deferred.promise},_saveTrainConfig:function(trainConfig){var me=this,s={},deferred=Q.defer();return s[me._TrainConfigPrefName]=JSON.stringify(trainConfig),Rally.data.PreferenceManager.update({workspace:me.getContext().getWorkspace()._ref,filterByName:me._TrainConfigPrefName,settings:s,success:deferred.resolve,failure:deferred.reject}),deferred.promise},_configureIntelRallyApp:function(){var me=this;return Q.all([me._loadPortfolioItemTypes().then(function(){return Q.all([me._loadModels(),me._loadPortfolioItemStatesForEachType()])}),me._loadTrainConfig(),me._loadScheduleStates()])},_reloadStore:function(store){var deferred=Q.defer();return store.load({callback:function(records,operation,success){success?deferred.resolve(store):deferred.reject(operation.getError()||"Could not load data")}}),deferred.promise},_loadProject:function(oid){var me=this,deferred=Q.defer();return oid?me.Project?(me.Project.load(oid,{fetch:me._projectFields,context:{workspace:me.getContext().getWorkspace()._ref,project:null},callback:deferred.resolve}),deferred.promise):Q.reject("IntelRallyApp is not configured!"):Q.reject("Invalid arguments: LP")},_loadUserStory:function(oid,projectRecord){var me=this,deferred=Q.defer();return oid?me.UserStory?(me.UserStory.load(oid,{fetch:me._userStoryFields,context:{workspace:projectRecord?null:me.getContext().getWorkspace()._ref,project:projectRecord?projectRecord.data._ref:null},callback:deferred.resolve}),deferred.promise):Q.reject("IntelRallyApp is not configured!"):Q.reject("Invalid arguments: LUS")},_loadPortfolioItemByType:function(oid,type){var me=this,deferred=Q.defer();return oid&&type?(me[type].load(oid,{fetch:me._portfolioItemFields,context:{workspace:me.getContext().getWorkspace()._ref,project:null},callback:deferred.resolve}),deferred.promise):Q.reject("Invalid arguments: LPIBT")},_loadPortfolioItemByOrdinal:function(oid,ordinal){var me=this,deferred=Q.defer(),type=me.PortfolioItemTypes[ordinal];return me._loadPortfolioItemByType(oid,type)},_projectInWhichTrain:function(projectRecord){if(projectRecord){var me=this,foundTrainConfig=_.find(me.TrainConfig,function(trainConfig){return trainConfig.TrainProjectOID==projectRecord.data.ObjectID});if(foundTrainConfig)return Q(projectRecord);var parent=projectRecord.data.Parent;return parent?me._loadProject(parent.ObjectID).then(function(parentRecord){return me._projectInWhichTrain(parentRecord)}):Q()}return Q()},_loadTrainPortfolioProject:function(trainRecord){if(!trainRecord)return Q.reject("Invalid arguments: ltpp");var me=this,foundTrainConfig=_.find(me.TrainConfig,function(trainConfig){return trainConfig.TrainProjectOID==trainRecord.data.ObjectID});return foundTrainConfig?foundTrainConfig.TrainAndPortfolioLocationTheSame?Q(trainRecord):me._loadProject(foundTrainConfig.PortfolioProjectOID):Q.reject("Project "+trainRecord.data.Name+" is not a train!")},_getTrainName:function(trainRecord){if(!trainRecord)throw"Invalid arguments: gtn";var me=this,foundTrainConfig=_.find(me.TrainConfig,function(trainConfig){return trainConfig.TrainProjectOID==trainRecord.data.ObjectID});if(!foundTrainConfig)throw"Project "+trainRecord.data.Name+" is not a train!";return foundTrainConfig.TrainName?foundTrainConfig.TrainName:trainRecord.data.Name},_loadAllTrains:function(){var me=this,filter=_.reduce(me.TrainConfig,function(filter,item){var newFilter=Ext.create("Rally.data.wsapi.Filter",{property:"ObjectID",value:item.TrainProjectOID});return filter?filter.or(newFilter):newFilter},null);if(filter){var store=Ext.create("Rally.data.wsapi.Store",{model:"Project",limit:1/0,disableMetaChangeEvent:!0,autoLoad:!1,fetch:me._projectFields,filters:[filter],context:{workspace:me.getContext().getWorkspace()._ref,project:null}});return me._reloadStore(store).then(function(store){return store.getRange()})}return Q([])},__getUserStoryInReleaseTimeFrameFilter:function(releaseRecord){var me=this,twoWeeks=12096e5,releaseStartPadding=new Date(1*new Date(releaseRecord.data.ReleaseStartDate)+twoWeeks).toISOString(),releaseEndPadding=new Date(1*new Date(releaseRecord.data.ReleaseDate)-twoWeeks).toISOString();return Ext.create("Rally.data.wsapi.Filter",{property:"Release.ReleaseStartDate",operator:"<",value:releaseStartPadding}).and(Ext.create("Rally.data.wsapi.Filter",{property:"Release.ReleaseDate",operator:">",value:releaseEndPadding})).or(Ext.create("Rally.data.wsapi.Filter",{property:"Release.ObjectID",value:null}).and(Ext.create("Rally.data.wsapi.Filter",{property:"PortfolioItem.Release.ReleaseStartDate",operator:"<",value:releaseStartPadding}).and(Ext.create("Rally.data.wsapi.Filter",{property:"PortfolioItem.Release.ReleaseDate",operator:">",value:releaseEndPadding}))))},_loadRandomUserStory:function(projectRecord){if(!projectRecord)return Q.reject("Invalid arguments: LRUS");var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"HierarchicalRequirement",limit:1,pageSize:1,disableMetaChangeEvent:!0,fetch:!1,context:{workspace:me.getContext().getWorkspace()._ref,project:void 0},filters:[{property:"Project.ObjectID",value:projectRecord.data.ObjectID}]});return me._reloadStore(store).then(function(store){return store.getRange().pop()})},_loadRandomUserStoryFromReleaseTimeframe:function(projectRecord,releaseRecord){if(!projectRecord||!releaseRecord)return Q.reject("Invalid arguments: LRUSFR");var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"HierarchicalRequirement",limit:5,pageSize:5,disableMetaChangeEvent:!0,fetch:me._userStoryFields,context:{workspace:me.getContext().getWorkspace()._ref,project:void 0},sorters:[{property:"CreationDate",direction:"DESC"}],filters:[Ext.create("Rally.data.wsapi.Filter",{property:"Project.ObjectID",value:projectRecord.data.ObjectID}).and(me.__getUserStoryInReleaseTimeFrameFilter(releaseRecord))]});return me._reloadStore(store).then(function(store){var records=store.data.items;return records.length?Q(records[Math.floor(Math.random()*records.length)]):Q(void 0)})},_loadUserStoryByFID:function(formattedID,projectRecord){if(!formattedID||!projectRecord)return Q.reject("Invalid arguments: LUSBFID");var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"HierarchicalRequirement",limit:1,pageSize:1,disableMetaChangeEvent:!0,fetch:["Name","Project","ObjectID","FormattedID","Predecessors","Successors","c_Dependencies"],context:{workspace:me.getContext().getWorkspace()._ref,project:void 0},filters:[{property:"FormattedID",value:formattedID},{property:"Project.ObjectID",value:projectRecord.data.ObjectID}]});return me._reloadStore(store).then(function(store){return Q(store.data.items.pop())})},_loadPortfolioItemsOfType:function(portfolioProject,type){if(!portfolioProject||!type)return Q.reject("Invalid arguments: OPIOT");var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"PortfolioItem/"+type,limit:1/0,disableMetaChangeEvent:!0,remoteSort:!1,fetch:me._portfolioItemFields,context:{project:portfolioProject.data._ref,projectScopeDown:!0,projectScopeUp:!1}});return me._reloadStore(store)},_loadPortfolioItemsOfOrdinal:function(portfolioProject,ordinal){if(!portfolioProject||ordinal===void 0)return Q.reject("Invalid arguments: LPIOO");var me=this,type=me.PortfolioItemTypes[ordinal];return type?me._loadPortfolioItemsOfType(portfolioProject,type):Q.reject("Invalid PortfolioItem ordinal")},_portfolioItemTypeToOrdinal:function(type){return this.PortfolioItemTypes.indexOf(type)},_getPortfolioItemTypeStateByOrdinal:function(ordinal,stateName){return _.find(this.PortfolioItemTypeStates[ordinal],function(state){return state.data.Name==stateName})},_getPortfolioItemTypeStateByName:function(portfolioType,stateName){return this._getPortfolioItemTypeStateByOrdinal(this._portfolioItemTypeToOrdinal(portfolioType),stateName)},__storeItemsToProjTree:function(projects){for(var me=this,projTree={},i=0,len=projects.length;len>i;++i){var project=projects[i],thisRef=project.data.ObjectID,parentRef=project.data.Parent?project.data.Parent.ObjectID:void 0;projTree[thisRef]||(projTree[thisRef]={}),projTree[thisRef].ProjectRecord=project,parentRef&&(projTree[parentRef]||(projTree[parentRef]={}),projTree[parentRef][thisRef]=projTree[thisRef])}return projTree},_loadAllProjects:function(){var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"Project",fetch:me._projectFields,limit:1/0,disableMetaChangeEvent:!0,context:{workspace:me.getContext().getWorkspace()._ref,project:null}});return me._reloadStore(store).then(function(store){var map=_.reduce(store.getRange(),function(map,project){return map[project.data.ObjectID]=project,map},{});return map})},__addProjectsWithTeamMembersToList:function(projTree,hash){var me=this,curProj=projTree.ProjectRecord;curProj.data.TeamMembers.Count>0&&(hash[curProj.data.ObjectID]=curProj);for(var childProjRef in projTree)"ProjectRecord"!==childProjRef&&me.__addProjectsWithTeamMembersToList(projTree[childProjRef],hash)},_loadProjectsWithTeamMembers:function(rootProjectRecord){var me=this,projectsWithTeamMembers={},store=Ext.create("Rally.data.wsapi.Store",{model:"Project",fetch:me._projectFields,limit:1/0,disableMetaChangeEvent:!0,context:{workspace:me.getContext().getWorkspace()._ref,project:null}});return me._reloadStore(store).then(function(store){if(rootProjectRecord){var projTree=me.__storeItemsToProjTree(store.getRange());return me.__addProjectsWithTeamMembersToList(projTree[rootProjectRecord.data.ObjectID],projectsWithTeamMembers),projectsWithTeamMembers}return _.reduce(_.filter(store.getRange(),function(project){return project.data.TeamMembers.Count>0}),function(map,project){return map[project.data.ObjectID]=project,map},{})})},__allChildProjectToList:function(projTree,hash){var me=this,curProj=projTree.ProjectRecord;hash[curProj.data.ObjectID]=curProj;for(var childProjRef in projTree)"ProjectRecord"!==childProjRef&&me.__allChildProjectToList(projTree[childProjRef],hash)},_loadAllChildrenProjects:function(rootProjectRecord){var me=this,childrenProjects={},store=Ext.create("Rally.data.wsapi.Store",{model:"Project",fetch:me._projectFields,limit:1/0,disableMetaChangeEvent:!0,context:{workspace:me.getContext().getWorkspace()._ref,project:null}});return me._reloadStore(store).then(function(store){if(rootProjectRecord){var projTree=me.__storeItemsToProjTree(store.getRange());return me.__allChildProjectToList(projTree[rootProjectRecord.data.ObjectID],childrenProjects),childrenProjects}return _.reduce(store.getRange(),function(map,project){return map[project.data.ObjectID]=project,map},{})})},__allLeafProjectsToList:function(projTree,hash){var me=this,curProj=projTree.ProjectRecord;0===curProj.data.Children.Count&&(hash[curProj.data.ObjectID]=curProj);for(var childProjRef in projTree)"ProjectRecord"!==childProjRef&&me.__allLeafProjectsToList(projTree[childProjRef],hash)},_loadAllLeafProjects:function(rootProjectRecord){var me=this,leafProjects={},store=Ext.create("Rally.data.wsapi.Store",{model:"Project",fetch:me._projectFields,limit:1/0,disableMetaChangeEvent:!0,context:{workspace:me.getContext().getWorkspace()._ref,project:null}});return me._reloadStore(store).then(function(store){if(rootProjectRecord){var projTree=me.__storeItemsToProjTree(store.getRange());return me.__allLeafProjectsToList(projTree[rootProjectRecord.data.ObjectID],leafProjects),leafProjects}return _.reduce(_.filter(store.getRange(),function(project){return 0===project.data.Children.Count}),function(map,project){return map[project.data.ObjectID]=project,map},{})})},_loadProjectByName:function(projectName){if(!projectName)return Q.reject("Invalid arguments: LPBN");var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"Project",limit:1,pageSize:1,fetch:["Name","ObjectID"],disableMetaChangeEvent:!0,context:{workspace:me.getContext().getWorkspace()._ref,project:null},filters:[{property:"Name",value:projectName}]});return me._reloadStore(store).then(function(store){return Q(store.data.items.pop())})},_loadAllReleases:function(projectRecord){var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"Release",limit:1/0,disableMetaChangeEvent:!0,autoLoad:!1,fetch:me._releaseFields,filters:[{property:"Project.ObjectID",value:projectRecord.data.ObjectID}],context:{workspace:me.getContext().getWorkspace()._ref,project:null}});return me._reloadStore(store).then(function(store){return store.getRange()})},_loadReleasesAfterGivenDate:function(projectRecord,givenDate){var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"Release",limit:1/0,disableMetaChangeEvent:!0,autoLoad:!1,fetch:me._releaseFields,filters:[{property:"ReleaseDate",operator:">=",value:new Date(givenDate).toISOString()},{property:"Project.ObjectID",value:projectRecord.data.ObjectID}],context:{workspace:me.getContext().getWorkspace()._ref,project:null}});return me._reloadStore(store).then(function(store){return store.getRange()})},_loadReleasesBeforeGivenDate:function(projectRecord,givenDate){var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"Release",limit:1/0,autoLoad:!1,disableMetaChangeEvent:!0,fetch:me._releaseFields,filters:[{property:"ReleaseDate",operator:"<=",value:new Date(givenDate).toISOString()},{property:"Project.ObjectID",value:projectRecord.data.ObjectID}],context:{workspace:me.getContext().getWorkspace()._ref,project:null}});return me._reloadStore(store).then(function(store){return store.getRange()})},_loadReleasesInTheFuture:function(projectRecord){return this._loadReleasesAfterGivenDate(projectRecord,new Date)},_loadReleasesByNameUnderProject:function(releaseName,projectRecord){var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"Release",limit:1/0,disableMetaChangeEvent:!0,autoLoad:!1,fetch:me._releaseFields,filters:[{property:"Name",value:releaseName}],context:{project:projectRecord.data._ref,projectScopeDown:!0,projectScopeUp:!1}});return me._reloadStore(store).then(function(store){return store.getRange()})},_loadReleaseByNameForProject:function(releaseName,projectRecord){var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"Release",limit:1/0,disableMetaChangeEvent:!0,autoLoad:!1,fetch:me._releaseFields,filters:[{property:"Name",value:releaseName},{property:"Project.ObjectID",value:projectRecord.data.ObjectID}],context:{workspace:me.getContext().getWorkspace()._ref,project:null}});return me._reloadStore(store).then(function(store){return store.getRange().pop()})},_loadReleasesByNameContainsForProject:function(releaseName,projectRecord){var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"Release",limit:1/0,disableMetaChangeEvent:!0,autoLoad:!1,fetch:me._releaseFields,filters:[{property:"Name",operator:"contains",value:releaseName},{property:"Project.ObjectID",value:projectRecord.data.ObjectID}],context:{workspace:me.getContext().getWorkspace()._ref,project:null}});return me._reloadStore(store).then(function(store){return store.getRange()})},_getScopedRelease:function(releaseRecords,projectOID,appPrefs){var me=this,d=new Date,rs=releaseRecords,prefOID=appPrefs&&appPrefs.projs&&appPrefs.projs[projectOID]&&appPrefs.projs[projectOID].Release;return prefOID&&_.find(rs,function(r){return r.data.ObjectID==prefOID})||_.find(rs,function(r){return new Date(r.data.ReleaseDate)>=d&&d>=new Date(r.data.ReleaseStartDate)})||_.reduce(rs,function(best,r){if(null===best)return r;var d1=new Date(best.data.ReleaseStartDate),d2=new Date(r.data.ReleaseStartDate),now=new Date;return Math.abs(d1-now)<Math.abs(d2-now)?best:r},null)}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("WorkweekDropdown",{extend:"Ext.data.Model",fields:[{name:"Workweek",type:"string"},{name:"DateVal",type:"number"}]}),Ext.define("TrainConfigItem",{extend:"Ext.data.Model",fields:[{name:"TrainProjectOID",type:"number"},{name:"TrainName",type:"string"},{name:"TrainAndPortfolioLocationTheSame",type:"boolean"},{name:"PortfolioProjectOID",type:"number"}]})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("WindowListener",{__initWindowEventListener:function(eventName){var me=this;me._windowListeners||(me._windowListeners={}),me._windowListeners[eventName]=[],window.parent["on"+eventName]=function(event){for(var listeners=me._windowListeners[eventName],i=0,len=listeners.length;len>i;++i)listeners[i](event)}},_addWindowEventListener:function(eventName,fn){var me=this;me._windowListeners&&me._windowListeners[eventName]||me.__initWindowEventListener(eventName),me._windowListeners[eventName].push(fn)},_fireParentWindowEvent:function(eventName){var me=this;if(me._windowListeners&&me._windowListeners[eventName])for(var listeners=me._windowListeners[eventName],i=0,len=listeners.length;len>i;++i)listeners[i]()}})})();
                (function(){var Ext=window.Ext4||window.Ext,TOP_BAR_HEIGHT=40,BOTTOM_BAR_HEIGHT=24,TITLE_BAR_HEIGHT=33,IFRAME_HEADER_HEIGHT=28;Ext.define("IframeResize",{requires:["WindowListener"],_fixRallyDashboard:function(){if(window.frameElement){for(var me=this,bottomEl=Ext.get(window.frameElement),portlet=bottomEl.up(".x-portlet"),dashboard=portlet.up("#mydash_portlet"),titleBar=dashboard.down(".titlebar"),domNodeW=bottomEl.dom,domNodeH=bottomEl.dom,innerHeight=window.parent.innerHeight,innerWidth=window.parent.innerWidth;;){if(domNodeW.style.width=innerWidth-4+"px",domNodeW.style.padding="0",domNodeW.style.margin="0","mydash_portlet"===domNodeW.id)break;domNodeW=domNodeW.parentNode}for(;;){if(domNodeH.style.height=innerHeight-(TOP_BAR_HEIGHT+BOTTOM_BAR_HEIGHT+TITLE_BAR_HEIGHT+IFRAME_HEADER_HEIGHT)+"px",domNodeH.classList.contains("x-portlet"))break;domNodeH=domNodeH.parentNode}for(;;){if(domNodeH.style.height=innerHeight-(TOP_BAR_HEIGHT+BOTTOM_BAR_HEIGHT+TITLE_BAR_HEIGHT)+"px","mydash_portlet"==domNodeH.id)break;domNodeH=domNodeH.parentNode}dashboard.dom.style.height=innerHeight-(TOP_BAR_HEIGHT+BOTTOM_BAR_HEIGHT)+"px",dashboard.dom.style.padding="0 2px 0 2px",titleBar.dom.style.padding="2px",titleBar.dom.style.margin="0"}},_initFixRallyDashboard:function(){var me=this;me._addWindowEventListener&&me._addWindowEventListener("resize",function(){me._fixRallyDashboard()}),me._fixRallyDashboard()},_disableResizeHandle:function(){var me=this,handle;window.frameElement&&(handle=Ext.get(window.frameElement).up(".x-portlet").down(".x-resizable-handle"),handle&&(handle.hide(),handle.dom.onshow=function(){handle&&handle.hide()}))},_initDisableResizeHandle:function(){var me=this;me._addWindowEventListener&&me._addWindowEventListener("resize",function(){me._disableResizeHandle()}),me._disableResizeHandle()}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("PrettyAlert",{__getMessageBoxY:function(){var me=this,bottomEl=window.frameElement?Ext.get(window.frameElement):me.el,ph=window.frameElement?window.parent.getWindowHeight():window.innerHeight,ps=window.frameElement?window.parent.getScrollY():window.scrollY,ofy=ps+bottomEl.dom.getBoundingClientRect().top,iyOffset=Math.floor(ph/2-ofy+ps-50);return 0>iyOffset?0:iyOffset},_alert:function(title,message){var me=this;message="string"==typeof message?message:message.message?message.message:JSON.stringify(message,null,"	"),1>arguments.length||(1===arguments.length&&(message=title,title=""),Ext.MessageBox.alert(title,message).setY(me.__getMessageBoxY()),setTimeout(function(){for(var x=Ext.MessageBox.down("button");x.isHidden();)x=x.nextSibling();x.focus()},50))},_confirm:function(title,message,fn){var me=this;message="string"==typeof message?message:message.message?message.message:JSON.stringify(message,null,"	"),2>arguments.length||(2===arguments.length&&(fn=message,message=title,title=""),"function"!=typeof fn&&(fn=function(){}),Ext.MessageBox.confirm(title,message,fn).setY(me.__getMessageBoxY()),setTimeout(function(){for(var x=Ext.MessageBox.down("button");x.isHidden();)x=x.nextSibling();x.focus()},20))}})})();
                (function(){var Ext=window.Ext4||window.Ext,intel_ww={},SECOND=1e3,MINUTE=60*SECOND,HOUR=60*MINUTE,DAY=24*HOUR,WEEK=7*DAY;Ext.define("IntelWorkweek",{_getWorkweek:function(_date){var date=new Date(_date),yearStart=new Date(date.getFullYear(),0,1),dayIndex=yearStart.getDay(),ww01Start=new Date(yearStart-dayIndex*DAY),utcDateMillis=Date.UTC(date.getFullYear(),date.getMonth(),date.getDate()),ww01Millis=Date.UTC(ww01Start.getFullYear(),ww01Start.getMonth(),ww01Start.getDate()),timeDiff=utcDateMillis-ww01Millis,ww=Math.floor(timeDiff/WEEK)+1,leap=0===date.getFullYear()%4,weekCount=leap&&dayIndex>=5||!leap&&6===dayIndex?53:52;return ww>weekCount?1:ww},_getWeekCount:function(_date){var date=new Date(_date),leap=0===date.getFullYear()%4,day=new Date(date.getFullYear(),0,1).getDay();return leap&&day>=5||!leap&&6===day?53:52},_roundDateDownToWeekStart:function(_date){var date=new Date(_date),day=date.getDay(),monthDate=date.getDate(),month=date.getMonth(),year=date.getFullYear(),sundayMidday=new Date(1*new Date(year,month,monthDate)-(day*DAY-.5*DAY));return new Date(sundayMidday.getFullYear(),sundayMidday.getMonth(),sundayMidday.getDate())},_getWorkweekDates:function(startDate,endDate){for(var startWeekDate=this._roundDateDownToWeekStart(startDate),endWeekDate=this._roundDateDownToWeekStart(endDate),startMillis=Date.UTC(startWeekDate.getFullYear(),startWeekDate.getMonth(),startWeekDate.getDate()),endMillis=Date.UTC(endWeekDate.getFullYear(),endWeekDate.getMonth(),endWeekDate.getDate()),totalWeeks=Math.floor((endMillis-startMillis)/WEEK)+1,weeks=Array(totalWeeks),i=0;totalWeeks>i;++i){var sundayMidday=new Date(1*startWeekDate+(WEEK*i+12*HOUR));weeks[i]=new Date(sundayMidday.getFullYear(),sundayMidday.getMonth(),sundayMidday.getDate())}return weeks},_workweekToDate:function(ww,year){var yearStart=new Date(year,0,1),dayIndex=yearStart.getDay(),ww01StartMidday=new Date(yearStart-(dayIndex*DAY-.5*DAY)),sundayMidday=new Date(1*ww01StartMidday+(ww-1)*WEEK);return new Date(sundayMidday.getFullYear(),sundayMidday.getMonth(),sundayMidday.getDate())},_getWorkWeeksForDropdown:function(releaseStartDate,releaseEndDate){for(var workweeks=this._getWorkweekDates(releaseStartDate,releaseEndDate),data=Array(workweeks.length),i=0,len=workweeks.length;len>i;++i)data[i]={Workweek:"ww"+this._getWorkweek(workweeks[i]),DateVal:1*workweeks[i]};return data}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("AsyncQueue",{QueueOfFuncs:{},_dequeue:function(queueName){var me=this;if(queueName=queueName||"undefined",me.QueueOfFuncs[queueName]){if(me.QueueOfFuncs[queueName].shift(),!me.QueueOfFuncs[queueName].length)return;me.QueueOfFuncs[queueName][0].call(me,me._dequeue.bind(me,queueName))}},_enqueue:function(callback,queueName){var me=this;if(queueName=queueName||"undefined","function"!=typeof callback)throw"ERROR: not a function";me.QueueOfFuncs[queueName]&&me.QueueOfFuncs[queueName].length?me.QueueOfFuncs[queueName].push(callback):(me.QueueOfFuncs[queueName]=[callback],callback.call(me,me._dequeue.bind(me,queueName)))}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("ParallelLoader",{__parallelLoadData:function(config){var me=this,pagesize=config.pagesize,url=config.url,params=config.params,promises=[],outputItems=[],totalRequestsSent=1;return _.times(totalRequestsSent,function(pageNum){var thisDeferred=Q.defer(),thisParams=Ext.merge({},params);promises.push(thisDeferred.promise),thisParams.start=config.itemOffset+pagesize*pageNum,Ext.data.JsonP.request({url:url,callbackKey:"jsonp",timeout:12e4,params:thisParams,success:function(resJSON){var items=resJSON.QueryResult?resJSON.QueryResult.Results:resJSON.Results,totalCount=resJSON.QueryResult?resJSON.QueryResult.TotalResultCount:resJSON.TotalResultCount,totalPages=(totalCount/pagesize>>0)+(totalCount%pagesize?1:0);if(outputItems=outputItems.concat(items),totalPages>totalRequestsSent){var additionalPromises=[];_.times(totalPages-totalRequestsSent,function(){var nextDeferred=Q.defer(),thisParams=Ext.merge({},params);additionalPromises.push(nextDeferred.promise),thisParams.start=config.itemOffset+pagesize*totalRequestsSent,++totalRequestsSent,Ext.data.JsonP.request({url:url,callbackKey:"jsonp",timeout:12e4,params:thisParams,success:function(resJSON){var items=resJSON.QueryResult?resJSON.QueryResult.Results:resJSON.Results;outputItems=outputItems.concat(items),nextDeferred.resolve()},failure:function(response){nextDeferred.reject(response)}})}),Q.all(additionalPromises).then(function(){thisDeferred.resolve()})}else thisDeferred.resolve()},failure:function(response){thisDeferred.reject(response)}})}),Q.all(promises).then(function(){return outputItems})},_parallelLoadWsapiStore:function(config){var me=this;return config.itemOffset=1,config.pagesize=config.pagesize>0&&200>=config.pagesize?config.pagesize:200,me.__parallelLoadData(config).then(function(items){return Ext.create("Rally.data.wsapi.Store",{model:config.model,totalCount:items.length,data:items,disableMetaChangeEvent:!0,load:function(){}})})},_parallelLoadLookbackStore:function(config){var me=this;return config.itemOffset=0,config.pagesize=config.pagesize>0&&2e4>=config.pagesize?config.pagesize:2e4,me.__parallelLoadData(config).then(function(items){return Ext.create("Rally.data.lookback.SnapshotStore",{totalCount:items.length,data:items,disableMetaChangeEvent:!0,model:Ext.define("Rally.data.lookback.SnapshotModel-"+Ext.id(),{extend:"Rally.data.lookback.SnapshotModel",fields:JSON.parse(config.params.fields||"[]")}),load:function(){}})})}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("UserAppsPreference",{_userAppsPref:"intel-user-apps-preference",_loadAppsPreference:function(){var me=this,deferred=Q.defer();return Rally.data.PreferenceManager.load({filterByUser:!0,filterByName:me._userAppsPref,success:function(prefs){var appPrefs=prefs[me._userAppsPref];try{appPrefs=JSON.parse(appPrefs)}catch(e){appPrefs={projs:{},refresh:0}}deferred.resolve(appPrefs)},failure:deferred.reject}),deferred.promise},_saveAppsPreference:function(prefs){var me=this,s={},deferred=Q.defer();return prefs={projs:prefs.projs,refresh:prefs.refresh},s[me._userAppsPref]=JSON.stringify(prefs),Rally.data.PreferenceManager.update({filterByUser:!0,filterByName:me._userAppsPref,settings:s,success:deferred.resolve,failure:deferred.reject}),deferred.promise}})})();
                (function(){var Ext=window.Ext4||window.Ext,POLL_INTERVAL_MS=10;Ext.define("Skirtle.CTemplate",{extend:"Ext.XTemplate",statics:{AUTO_ID:0},copyDepth:10,cTpl:'<p id="ctemplate-{0}-{1}"></p>',isCTemplate:!0,constructor:function(){var me=this;me.callParent(arguments),me.id=++me.statics().AUTO_ID,me.reset()},copyValues:function(values,depth){var me=this,id,copy={},copyDepth=depth||me.copyDepth;return 1===copyDepth?values:Ext.isArray(values)?Ext.Array.map(values,function(value){return me.copyValues(value,copyDepth-1)}):Ext.isObject(values)?values.isComponent?(id=values.getId(),me.ids.push(id),Ext.String.format(me.cTpl,id,me.id)):(Ext.Object.each(values,function(key,value){copy[key]="$comp"===key?value:me.copyValues(value,copyDepth-1)}),copy):values},doInsert:function(){var ret=this.callParent(arguments);return this.injectComponents(),ret},doPolling:function(interval){var me=this;me.pollInterval=interval,me.pollId&&clearTimeout(me.pollId),me.pollId=Ext.defer(me.injectComponents,interval,me)},getPlaceholderEl:function(id){return Ext.get("ctemplate-"+id+"-"+this.id)},injectComponents:function(){for(var me=this,ids=me.ids,index=ids.length-1,id,cmp,placeholderEl;index>=0;--index)id=ids[index],cmp=Ext.getCmp(id),placeholderEl=me.getPlaceholderEl(id),(me.renderComponent(cmp,placeholderEl)||!cmp)&&(Ext.Array.splice(ids,index,1),placeholderEl&&placeholderEl.remove());ids.length&&me.doPolling(me.pollInterval)},overwrite:function(el){var dom,firstChild,ret;if(Ext.isIE)for(dom=Ext.getDom(el);dom.firstChild;)dom.removeChild(dom.firstChild);return ret=this.callParent(arguments),this.injectComponents(),ret},renderComponent:function(cmp,placeholderEl){if(cmp&&placeholderEl){var parent=placeholderEl.parent();return cmp.rendered?cmp.getEl().replace(placeholderEl):cmp.render(parent,placeholderEl),Ext.isIE6&&parent.repaint(),!0}return!1},reset:function(){var me=this;me.ids=[],me.pollId&&(clearTimeout(me.pollId),me.pollId=null)}},function(ctemplate){var apply=function(){var me=this,args=Ext.Array.slice(arguments);return args[0]=me.copyValues(args[0]),me.doPolling(POLL_INTERVAL_MS),me.callParent(args)};ctemplate.prototype.applyOut?ctemplate.override({applyOut:apply}):(ctemplate.override({applyTemplate:apply}),ctemplate.createAlias("apply","applyTemplate"))}),Ext.define("Skirtle.grid.column.Component",{alias:"widget.componentcolumn",extend:"Ext.grid.column.Column",requires:["Skirtle.CTemplate"],autoWidthComponents:!0,componentGC:!0,hasCustomRenderer:!0,lastFrameWidth:12,widthUpdateDelay:[10,400],constructor:function(cfg){var me=this;me.callParent(arguments),me.compIds=[],me.dataIndex=me.dataIndex||Ext.id(null,"cc-dataIndex-"),me.tpl=me.createTemplate(me.tpl),me.renderer=me.createRenderer(me.renderer),me.registerColumnListeners()},addRefOwner:function(child){var me=this,fn=me.refOwnerFn||(me.refOwnerFn=function(){return me});40200>me.extVersion?child.getBubbleTarget=fn:child.getRefOwner=fn},applyTemplate:function(data,value){return Ext.isDefined(value)&&(data[this.dataIndex]=value),this.tpl.apply(data)},beforeViewRefresh:function(){if(Ext.isIE)for(var ids=this.compIds,index=0,len=ids.length,item,el,parentEl;len>index;index++)(item=Ext.getCmp(ids[index]))&&(el=item.getEl())&&(el=el.dom)&&(parentEl=el.parentNode)&&parentEl.removeChild(el)},calculateFrameWidth:function(component){var el=component.getEl(),parentDiv=el&&el.parent(),parentTd=parentDiv&&parentDiv.parent();return parentTd?(this.lastFrameWidth=parentDiv.getFrameWidth("lr")+parentTd.getFrameWidth("lr"),this.lastFrameWidth):void 0},createRenderer:function(renderer){var me=this;return function(value,p,record){var data=Ext.apply({},record.data,record.getAssociatedData());return renderer&&(value=renderer.apply(this,arguments)),value=me.processValue(value),me.applyTemplate(data,value)}},createTemplate:function(tpl){return tpl&&tpl.isTemplate?tpl:Ext.create("Skirtle.CTemplate",tpl||["{",this.dataIndex,"}"])},destroyChild:function(child){child.destroy()},getRefItems:function(deep){for(var items=this.callParent([deep]),ids=this.compIds,index=0,len=ids.length,item;len>index;index++)item=Ext.getCmp(ids[index]),item&&(items.push(item),deep&&item.getRefItems&&items.push.apply(items,item.getRefItems(!0)));return items},onChildAfterRender:function(child){this.resizeChild(child)},onChildBoxReady:function(child){this.resizeChild(child,!1)},onChildDestroy:function(child){Ext.Array.remove(this.compIds,child.getId())},onChildResize:function(){this.redoScrollbars()},onColumnResize:function(column){column.resizeAll()},onColumnShow:function(column){column.resizeAll()},onColumnVisibilityChange:function(column){var items=column.getRefItems(),index=0,length=items.length,visible=!column.isHidden();for(Ext.suspendLayouts&&Ext.suspendLayouts();length>index;++index)items[index].setVisible(visible);Ext.resumeLayouts&&Ext.resumeLayouts(!0)},onDestroy:function(){Ext.destroy(this.getRefItems()),this.callParent()},onRender:function(){this.registerViewListeners(),this.callParent(arguments)},onViewChange:function(){var me=this,tpl=me.tpl;me.suspendResizing(),tpl.isCTemplate&&(tpl.injectComponents(),tpl.reset()),me.redoScrollbars(),me.resumeResizing(),me.performGC()},performGC:function(){for(var compIds=this.compIds,index=compIds.length-1,comp,el;index>=0;--index)comp=Ext.getCmp(compIds[index]),el=comp&&comp.getEl(),el&&(!this.componentGC||el.dom&&Ext.getDom(Ext.id(el))===el.dom)||comp&&!comp.isDestroyed&&comp.destroy()},processValue:function(value){var me=this,compIds=me.compIds,id,initialWidth,dom,parent;return Ext.isObject(value)&&!value.isComponent&&value.xtype&&(value=Ext.widget(value.xtype,value)),value&&value.isComponent&&(id=value.getId(),Ext.Array.contains(compIds,id)||compIds.push(id),me.addRefOwner(value),me.registerListeners(value),value.rendered?Ext.isIE&&(dom=value.el.dom,parent=dom.parentNode,parent&&(40101===me.extVersion&&Ext.core.DomHelper.insertBefore(dom,{tag:"p"}),parent.removeChild(dom))):me.autoWidthComponents&&(initialWidth=me.getWidth()-me.lastFrameWidth,initialWidth=initialWidth>4?initialWidth:4,value.setWidth(initialWidth)),(Ext.isIE6||Ext.isIE7)&&me.isHidden()&&value.hide()),value},redoScrollbars:function(){var me=this,grid=me.up("tablepanel");if(grid){if(me.resizeQueue)return me.redoScrollbarsRequired=!0,void 0;40100>me.extVersion?(grid.invalidateScroller(),grid.determineScrollbars()):grid.doLayout()}},registerColumnListeners:function(){var me=this;me.autoWidthComponents&&(me.on("resize",me.onColumnResize),me.on("show",me.onColumnShow)),(Ext.isIE6||Ext.isIE7)&&me.on({hide:me.onColumnVisibilityChange,show:me.onColumnVisibilityChange})},registerListeners:function(component){var me=this;component.on("destroy",me.onChildDestroy,me),me.autoWidthComponents&&(component.on("afterrender",me.onChildAfterRender,me,{single:!0}),me.extVersion>=40100&&component.on("boxready",me.onChildBoxReady,me,{single:!0})),component.on("resize",me.onChildResize,me)},registerViewListeners:function(){var me=this,view=me.up("tablepanel").getView();me.mon(view,"beforerefresh",me.beforeViewRefresh,me),me.mon(view,"refresh",me.onViewChange,me),me.mon(view,"itemupdate",me.onViewChange,me),me.mon(view,"itemadd",me.onViewChange,me),me.mon(view,"itemremove",me.onViewChange,me)},resizeAll:function(){var me=this;me.suspendResizing(),me.resizeQueue=me.getRefItems(),me.resumeResizing()},resizeChild:function(component,defer){var me=this,frameWidth,newWidth,oldWidth,resizeQueue;return me.resizingSuspended?(resizeQueue=me.resizeQueue,Ext.Array.contains(resizeQueue,component)||resizeQueue.push(component),void 0):(frameWidth=me.calculateFrameWidth(component),Ext.isNumber(frameWidth)&&(newWidth=me.getWidth()-frameWidth,oldWidth=component.getWidth(),me.setChildWidth(component,newWidth,oldWidth)&&defer!==!1&&Ext.each(me.widthUpdateDelay,function(delay){Ext.defer(me.resizeChild,delay,me,[component,!1])})),void 0)},resumeResizing:function(){var me=this,index=0,resizeQueue=me.resizeQueue,len=resizeQueue.length;if(!--me.resizingSuspended){for(;len>index;++index)me.resizeChild(resizeQueue[index]);me.resizeQueue=null,me.redoScrollbarsRequired&&me.redoScrollbars()}},setChildWidth:function(component,newWidth,oldWidth){return oldWidth===newWidth?!1:(component.setWidth(newWidth),!0)},suspendResizing:function(){var me=this;me.resizingSuspended=(me.resizingSuspended||0)+1,me.resizeQueue||(me.resizeQueue=[])}},function(cls){var proto=cls.prototype,version=Ext.getVersion();proto.extVersion=100*(100*version.getMajor()+version.getMinor())+version.getPatch(),Ext.Element.prototype.syncContent&&"4.1.0"==""+version&&(proto.extVersion=40101)})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("IntelComboBox",{extend:"Ext.form.field.ComboBox",alias:["widget.intelcombo","widget.intelcombobox"],constructor:function(options){options=options||{},options=Ext.merge({enableKeyEvents:!0,queryMode:"local",ignoreNoChange:!0,allowBlank:!0,listeners:{keyup:function(a,b){if(!(b.keyCode>=37&&40>=b.keyCode)){var combo=this;combo.store.clearFilter(),combo.store.filterBy(function(item){return null!==item.data[combo.displayField].match(RegExp(combo.getRawValue(),"i"))})}},focus:function(combo){combo.store.clearFilter(),combo.setValue(""),combo.expand()}}},options),this.callParent([options])}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("IntelFixedComboBox",{extend:"Ext.form.field.ComboBox",alias:["widget.intelfixedcombo","widget.intelfixedcombobox"],constructor:function(options){options=options||{},options=Ext.merge({editable:!1,allowBlank:!0,queryMode:"local",listeners:{change:function(combo,newval,oldval){0===newval.length&&combo.setValue(oldval)},focus:function(combo){combo.setValue(""),combo.expand()}}},options),this.callParent([options])}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("IntelReleasePicker",{extend:"IntelFixedComboBox",alias:["widget.intelreleasepicker"],constructor:function(options){options.releases&&options.currentRelease&&(options.displayField="Name",options.value=options.currentRelease.data.Name,options.store=Ext.create("Ext.data.Store",{fields:["Name"],sorters:[function(o1,o2){return o1.data.Name>o2.data.Name?-1:1}],data:_.map(options.releases,function(r){return{Name:r.data.Name}})}),options.fieldLabel=options.fieldLabel||"Release:",options.editable=options.editable||!1,options.width=options.width||240,options.labelWidth=options.labelWidth||50,this.callParent([options]))}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("IntelTextarea",{extend:"Ext.form.field.TextArea",alias:["widget.inteltextarea"],grow:!0,growMin:20,growMax:160,maxLength:150,enforceMaxLength:!0,enterIsSpecial:!0})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("intel.grid.column.Component.",{alias:"widget.fastgridcolumn",extend:"Skirtle.grid.column.Component",autoWidthComponents:!1,componentGC:!0,hasCustomRenderer:!0,lastFrameWidth:12,constructor:function(cfg){var me=this;me.callParent(arguments)},registerViewListeners:function(){var me=this,view=me.up("tablepanel").getView();me.mon(view,"beforerefresh",me.beforeViewRefresh,me),me.mon(view,"refresh",me.onViewChange,me)},onViewChange:function(){var me=this,tpl=me.tpl;me.suspendResizing(),tpl.isCTemplate&&(tpl.injectComponents(),tpl.reset()),me.resumeResizing(),me.performGC()},resumeResizing:function(){var me=this,index=0,resizeQueue=me.resizeQueue,len=resizeQueue.length;if(!--me.resizingSuspended){for(;len>index;++index)me.resizeChild(resizeQueue[index]);me.resizeQueue=null}},onChildResize:function(){}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("Intel.data.proxy.SessionStorage",{extend:"Ext.data.proxy.SessionStorage",alias:"proxy.fastsessionproxy",constructor:function(cfg){var me=this;me.callParent(arguments)},create:function(operation,callback,scope){var me=this,records=operation.records,length=records.length,ids=me.getIds(),id,record,i;for(operation.setStarted(),void 0===me.isHierarchical&&(me.isHierarchical=!!records[0].isNode,me.isHierarchical&&me.getStorageObject().setItem(me.getTreeKey(),!0)),i=0;length>i;i++)record=records[i],record.phantom?(record.phantom=!1,id=me.getNextId()):id=record.getId(),record.beginEdit(),me.setRecord(record,id),record.endEdit(!0),record.commit(!0),ids.push(id);me.setIds(ids),operation.setCompleted(),operation.setSuccessful(),"function"==typeof callback&&callback.call(scope||me,operation)},update:function(operation,callback,scope){var records=operation.records,length=records.length,ids=this.getIds(),record,id,i;for(operation.setStarted(),i=0;length>i;i++)record=records[i],this.setRecord(record),record.commit(!0),id=record.getId(),void 0!==id&&-1==Ext.Array.indexOf(ids,id)&&ids.push(id);this.setIds(ids),operation.setCompleted(),operation.setSuccessful(),"function"==typeof callback&&callback.call(scope||this,operation)}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("Intel.data.FastStore",{extend:"Ext.data.Store",alias:"store.faststore",constructor:function(cfg){var me=this;me.callParent(arguments)},afterEdit:function(record,modifiedFieldNames){var me=this,i,shouldSync;if(me.autoSync&&!me.autoSyncSuspended)for(i=modifiedFieldNames.length;i--;)if(record.fields.get(modifiedFieldNames[i]).persist){me.sync();break}me.onUpdate(record,Ext.data.Model.EDIT,modifiedFieldNames)}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("Intel.grid.plugin.CellEditing",{alias:"plugin.fastcellediting",extend:"Ext.grid.plugin.CellEditing",triggerEvent:"cellclick",onEditComplete:function(ed,value,startValue){var me=this,activeColumn=me.getActiveColumn(),context=me.context,record;if(activeColumn){if(record=context.record,me.setActiveEditor(null),me.setActiveColumn(null),me.setActiveRecord(null),context.value=value,!me.validateEdit())return me.editing=!1,void 0;record.beginEdit(),record.isEqual(value,startValue)||record.set(activeColumn.dataIndex,value),context.view.focusRow(context.rowIdx,100),me.fireEvent("edit",me,context),record.endEdit(),me.editing=!1}}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("Intel.view.ScrollTable",{extend:"Ext.view.Table",alias:"widget.scrolltableview",constructor:function(cfg){var me=this;me.callParent(arguments)},refresh:function(){var me=this,targetEl,targetParent,oldDisplay,nextSibling,dom,records,el=me.getEl(),scroll=el&&el.getScrollTop();me.rendered&&!me.isDestroyed&&(me.hasListeners.beforerefresh&&me.fireEvent("beforerefresh",me)===!1||(targetEl=me.getTargetEl(),records=me.getViewRange(),dom=targetEl.dom,me.preserveScrollOnRefresh||(targetParent=dom.parentNode,oldDisplay=dom.style.display,dom.style.display="none",nextSibling=dom.nextSibling,targetParent.removeChild(dom)),me.refreshCounter?me.clearViewEl():(me.fixedNodes=targetEl.dom.childNodes.length,me.refreshCounter=1),me.tpl.append(targetEl,me.collectData(records,me.all.startIndex)),1>records.length?(this.store.loading||me.deferEmptyText&&!me.hasFirstRefresh||Ext.core.DomHelper.insertHtml("beforeEnd",targetEl.dom,me.emptyText),me.all.clear()):(me.collectNodes(targetEl.dom),me.updateIndexes(0)),me.hasFirstRefresh&&(me.refreshSelmodelOnRefresh!==!1?me.selModel.refresh():me.selModel.pruneIf()),me.hasFirstRefresh=!0,me.preserveScrollOnRefresh||(targetParent.insertBefore(dom,nextSibling),dom.style.display=oldDisplay),Ext.suspendLayouts(),this.refreshSize(),me.fireEvent("refresh",me),Ext.resumeLayouts(!0),me.viewReady||(me.viewReady=!0,me.fireEvent("viewready",me))),scroll&&me.preserveScrollOnRefresh&&el.setScrollTop(scroll))},onRemove:function(ds,records,indexes){var me=this,fireItemRemove=me.hasListeners.itemremove,i,record,index,el=me.getEl(),scroll=el&&el.getScrollTop();if(me.all.getCount()){if(0===me.dataSource.getCount()){if(fireItemRemove)for(i=indexes.length-1;i>=0;--i)me.fireEvent("itemremove",records[i],indexes[i])}else{for(i=indexes.length-1;i>=0;--i)record=records[i],index=indexes[i],me.doRemove(record,index),fireItemRemove&&me.fireEvent("itemremove",record,index);me.updateIndexes(indexes[0])}this.refreshSize(),scroll&&me.preserveScrollOnRefresh&&el.setScrollTop(scroll)}},onUpdate:function(ds,record){var me=this,index,node,el=me.getEl(),scroll=el&&el.getScrollTop();if(me.viewReady){if(index=me.dataSource.indexOf(record),index>-1&&(node=me.bufferRender([record],index)[0],me.getNode(record)))return me.all.replaceElement(index,node,!0),me.updateIndexes(index,index),me.selModel.onUpdate(record),me.hasListeners.itemupdate&&me.fireEvent("itemupdate",record,index,node),node;scroll&&me.preserveScrollOnRefresh&&el.setScrollTop(scroll)}},onAdd:function(store,records,index){var me=this,nodes,el=me.getEl(),scroll=el&&el.getScrollTop();me.rendered&&(0===me.all.getCount()?(me.refresh(),nodes=me.all.slice()):(nodes=me.doAdd(records,index),me.refreshSelmodelOnRefresh!==!1&&me.selModel.refresh(),me.updateIndexes(index)),me.hasListeners.itemadd&&me.fireEvent("itemadd",records,index,nodes),scroll&&me.preserveScrollOnRefresh&&el.setScrollTop(scroll))},scrollRowIntoView:function(row){return 0===row?(this.getEl().setScrollTop(0),void 0):(row=this.getNode(row,!0),row&&Ext.fly(row).scrollIntoView(this.el,!1),void 0)}})})();
                (function(){var Ext=window.Ext4||window.Ext;Ext.define("IntelVelocity",{extend:"Ext.data.Model",fields:[{name:"Name",type:"string"},{name:"PlannedVelocity",type:"number"},{name:"RealVelocity",type:"number"}]}),Ext.define("IntelTeamCommits",{extend:"Ext.data.Model",fields:[{name:"PortfolioItemObjectID",type:"number"},{name:"PortfolioItemRank",type:"number"},{name:"PortfolioItemName",type:"string"},{name:"PortfolioItemFormattedID",type:"string"},{name:"PortfolioItemPlannedEnd",type:"number"},{name:"TopPortfolioItemName",type:"string"},{name:"Commitment",type:"string"},{name:"Expected",type:"boolean"},{name:"Objective",type:"string"}]}),Ext.define("IntelRisk",{extend:"Ext.data.Model",fields:[{name:"RiskID",type:"string"},{name:"PortfolioItemObjectID",type:"number"},{name:"PortfolioItemFormattedID",type:"string"},{name:"PortfolioItemName",type:"string"},{name:"Description",type:"string"},{name:"Impact",type:"string"},{name:"MitigationPlan",type:"string"},{name:"Urgency",type:"string"},{name:"Status",type:"string"},{name:"Contact",type:"string"},{name:"Checkpoint",type:"number"},{name:"Edited",type:"boolean"}]}),Ext.define("IntelPredecessorItem",{extend:"Ext.data.Model",fields:[{name:"PredecessorItemID",type:"string"},{name:"PredecessorUserStoryObjectID",type:"number"},{name:"PredecessorProjectObjectID",type:"number"},{name:"Supported",type:"string"},{name:"Assigned",type:"boolean"}]}),Ext.define("IntelPredecessorDependency",{extend:"Ext.data.Model",fields:[{name:"DependencyID",type:"string"},{name:"UserStoryObjectID",type:"number"},{name:"UserStoryFormattedID",type:"string"},{name:"UserStoryName",type:"string"},{name:"Description",type:"string"},{name:"NeededBy",type:"number"},{name:"Status",type:"string"},{name:"PredecessorItems",type:"auto"},{name:"Edited",type:"boolean"}]}),Ext.define("IntelSuccessorDependency",{extend:"Ext.data.Model",fields:[{name:"DependencyID",type:"string"},{name:"SuccessorUserStoryObjectID",type:"string"},{name:"SuccessorProjectObjectID",type:"string"},{name:"UserStoryObjectID",type:"number"},{name:"UserStoryFormattedID",type:"string"},{name:"UserStoryName",type:"string"},{name:"Description",type:"string"},{name:"NeededBy",type:"number"},{name:"Supported",type:"string"},{name:"Assigned",type:"boolean"},{name:"Edited",type:"boolean"}]}),Ext.define("IntelRiskForTracking",{extend:"Ext.data.Model",fields:[{name:"RiskID",type:"string"},{name:"PortfolioItemObjectID",type:"number"},{name:"PortfolioItemFormattedID",type:"string"},{name:"PortfolioItemName",type:"string"},{name:"TopPortfolioItemName",type:"string"},{name:"ProjectObjectID",type:"number"},{name:"Description",type:"string"},{name:"Impact",type:"string"},{name:"MitigationPlan",type:"string"},{name:"Urgency",type:"string"},{name:"Status",type:"string"},{name:"Contact",type:"string"},{name:"Checkpoint",type:"number"},{name:"Edited",type:"boolean"}]}),Ext.define("IntelPredecessorDependencyForTracking",{extend:"Ext.data.Model",fields:[{name:"DependencyID",type:"string"},{name:"UserStoryObjectID",type:"number"},{name:"UserStoryFormattedID",type:"string"},{name:"UserStoryName",type:"string"},{name:"TopPortfolioItemName",type:"string"},{name:"ProjectObjectID",type:"number"},{name:"Description",type:"string"},{name:"NeededBy",type:"number"},{name:"Status",type:"string"},{name:"PredecessorItems",type:"auto"},{name:"Edited",type:"boolean"}]}),Ext.define("CommitsMatrixPortfolioItem",{extend:"Ext.data.Model",fields:[{name:"PortfolioItemObjectID",type:"number"},{name:"PortfolioItemRank",type:"number"},{name:"PortfolioItemName",type:"string"},{name:"PortfolioItemFormattedID",type:"string"},{name:"PortfolioItemPlannedEnd",type:"number"},{name:"TopPortfolioItemName",type:"string"},{name:"MoSCoW",type:"string"}]}),Ext.define("SAFeCustomFieldsEditorModel",{extend:"Ext.data.Model",fields:[{name:"ItemFormattedID",type:"string"},{name:"ItemName",type:"string"},{name:"ProjectName",type:"string"},{name:"ReleaseName",type:"string"},{name:"CustomFieldValue",type:"string"}]})})();
                (function(){var Ext=window.Ext4||window.Ext,RALLY_MAX_STRING_SIZE=32768;Ext.define("RisksLib",{requires:["IntelRallyApp"],_getRisks:function(portfolioItemRecord){var risks=portfolioItemRecord.data.c_Risks;try{risks=JSON.parse(atob(risks))||{}}catch(e){risks={}}return risks},_removeRisk:function(portfolioItemRecord,riskData,projectRecord,risksParsedData){risksParsedData=risksParsedData||[];var me=this,risks=me._getRisks(portfolioItemRecord),projectOID=projectRecord.data.ObjectID,deferred=Q.defer();if(risks[projectOID]){delete risks[projectOID][riskData.RiskID];var indexToSplice=_.findIndex(risksParsedData,function(cachedRisk){return cachedRisk.RiskID===riskData.RiskID&&cachedRisk.PortfolioItemObjectID===riskData.PortfolioItemObjectID});indexToSplice>-1&&risksParsedData.splice(indexToSplice,1);var risksString=btoa(JSON.stringify(risks,null,"	"));risksString.length>=RALLY_MAX_STRING_SIZE?deferred.reject("Risks field for "+portfolioItemRecord.data.FormattedID+" ran out of space! Cannot save"):(portfolioItemRecord.set("c_Risks",risksString),portfolioItemRecord.save({callback:function(record,operation,success){success?deferred.resolve():deferred.reject("Failed to modify "+me.PortfolioItemTypes[0]+": "+portfolioItemRecord.data.FormattedID)}}))}else deferred.resolve();return deferred.promise},_addRisk:function(portfolioItemRecord,riskData,projectRecord,risksParsedData){risksParsedData=risksParsedData||[];var me=this,risks=me._getRisks(portfolioItemRecord),projectOID=projectRecord.data.ObjectID,deferred=Q.defer();riskData=Ext.clone(riskData),riskData.Edited=!1,risks[projectOID]||(risks[projectOID]={}),risks[projectOID][riskData.RiskID]={Checkpoint:riskData.Checkpoint,Description:riskData.Description,Impact:riskData.Impact,MitigationPlan:riskData.MitigationPlan,Urgency:riskData.Urgency,Status:riskData.Status,Contact:riskData.Contact};var indexToSplice=_.findIndex(risksParsedData,function(cachedRisk){return cachedRisk.RiskID===riskData.RiskID&&cachedRisk.PortfolioItemObjectID===riskData.PortfolioItemObjectID});indexToSplice>-1&&risksParsedData.splice(indexToSplice,1),risksParsedData.push(riskData);var risksString=btoa(JSON.stringify(risks,null,"	"));return risksString.length>=RALLY_MAX_STRING_SIZE?deferred.reject("Risks field for "+portfolioItemRecord.data.FormattedID+" ran out of space! Cannot save"):(portfolioItemRecord.set("c_Risks",risksString),portfolioItemRecord.save({callback:function(record,operation,success){success?deferred.resolve():deferred.reject("Failed to modify "+me.PortfolioItemTypes[0]+": "+portfolioItemRecord.data.FormattedID)}})),deferred.promise}})})();
                (function(){var Ext=window.Ext4||window.Ext,RALLY_MAX_STRING_SIZE=32768;Ext.define("DependenciesLib",{requires:["IntelRallyApp"],_getDependencies:function(userStoryRecord){var dependencies,dependencyString=userStoryRecord.data.c_Dependencies;if(""===dependencyString)dependencies={Predecessors:{},Successors:{}};else try{dependencies=JSON.parse(atob(dependencyString))}catch(e){dependencies={Predecessors:{},Successors:{}}}return dependencies.Predecessors||(dependencies.Predecessors={}),dependencies.Successors||(dependencies.Successors={}),dependencies},_syncCollection:function(userStoryRecord,depsToAdd,depsToRemove,collectionType){var me=this,syncDeferred=Q.defer();return depsToAdd=_.filter(depsToAdd,function(objectID){return!!objectID}),depsToRemove=_.filter(depsToRemove,function(objectID){return!!objectID}),userStoryRecord.getCollection(collectionType).load({fetch:["ObjectID"],callback:function(){var promises=[],syncCollectionProxy=!1,collectionStore=this,collectionRecords=collectionStore.getRange();_.each(depsToAdd,function(userStoryObjectID){_.find(collectionRecords,function(cr){return cr.data.ObjectID===userStoryObjectID})||promises.push(me._loadUserStory(userStoryObjectID).then(function(us){us&&(syncCollectionProxy=!0,collectionStore.add(us))}))}),_.each(depsToRemove,function(userStoryObjectID){var realDep=_.find(collectionRecords,function(cr){return cr.data.ObjectID===userStoryObjectID});realDep&&(collectionStore.remove(realDep),syncCollectionProxy=!0)});var attempts=0;Q.all(promises).then(function retrySync(){++attempts>5?(me._alert("INFO:","Failed to modify "+collectionType+" field on "+userStoryRecord.data.FormattedID),syncDeferred.resolve()):syncCollectionProxy?collectionStore.sync({failure:function(){retrySync()},success:function(){syncDeferred.resolve()}}):syncDeferred.resolve()}).fail(function(reason){syncDeferred.reject(reason)}).done()}}),syncDeferred.promise},_collectionSynced:function(userStoryRecord,dependencies){var me=this,dependenciesString=btoa(JSON.stringify(dependencies,null,"	")),deferred=Q.defer();if(dependenciesString.length>=RALLY_MAX_STRING_SIZE)deferred.reject("Dependencies field for "+userStoryRecord.data.FormattedID+" ran out of space! Cannot save");else{userStoryRecord.set("c_Dependencies",dependenciesString);var attempts=0;(function retrySync(){++attempts>5?deferred.reject("Failed to modify User Story "+userStoryRecord.data.FormattedID):userStoryRecord.save({callback:function(record,operation,success){success?deferred.resolve():retrySync()}})})()}return deferred.promise},_removePredecessor:function(userStoryRecord,predecessorData,currentProjectRecord,dependenciesParsedData){dependenciesParsedData=dependenciesParsedData||{},dependenciesParsedData.Predecessors=dependenciesParsedData.Predecessors||[];var me=this,dependencies=me._getDependencies(userStoryRecord),cachedPredecessors=dependenciesParsedData.Predecessors,depsToAdd=[],depsToRemove=[],dependencyID=predecessorData.DependencyID;return depsToRemove=_.map(dependencies.Predecessors[dependencyID].PredecessorItems||[],function(item){return item.PredecessorUserStoryObjectID}),delete dependencies.Predecessors[dependencyID],currentProjectRecord&&userStoryRecord.data.Project.ObjectID!==currentProjectRecord.data.ObjectID||(cachedPredecessors=_.filter(cachedPredecessors,function(cachedPredecessor){return cachedPredecessor.DependencyID!==dependencyID}),dependenciesParsedData.Predecessors=cachedPredecessors),_.each(dependencies.Predecessors,function(predecessor){_.each(predecessor.PredecessorItems,function(predecessorItem){predecessorItem.Assigned&&(depsToRemove=_.filter(depsToRemove,function(userStoryObjectID){return userStoryObjectID!=predecessorItem.PredecessorUserStoryObjectID}),depsToAdd=_.union(depsToAdd,[predecessorItem.PredecessorUserStoryObjectID]))})}),me._syncCollection(userStoryRecord,depsToAdd,depsToRemove,"Predecessors").then(function(){return me._collectionSynced(userStoryRecord,dependencies)})},_removeSuccessor:function(userStoryRecord,successorData,currentProjectRecord,dependenciesParsedData){dependenciesParsedData=dependenciesParsedData||{},dependenciesParsedData.Successors=dependenciesParsedData.Successors||[];var me=this,dependencies=me._getDependencies(userStoryRecord),cachedSuccessors=dependenciesParsedData.Successors,depsToAdd=[],depsToRemove=[successorData.SuccessorUserStoryObjectID],dependencyID=successorData.DependencyID;return delete dependencies.Successors[dependencyID],currentProjectRecord&&userStoryRecord.data.Project.ObjectID!==currentProjectRecord.data.ObjectID||(cachedSuccessors=_.filter(cachedSuccessors,function(cachedSuccessor){return cachedSuccessor.DependencyID!==dependencyID}),dependenciesParsedData.Successors=cachedSuccessors),_.each(dependencies.Successors,function(successor){successor.Assigned&&(depsToRemove=_.filter(depsToRemove,function(userStoryObjectID){return userStoryObjectID!=successor.SuccessorUserStoryObjectID}),depsToAdd=_.union(depsToAdd,[successor.SuccessorUserStoryObjectID]))}),me._syncCollection(userStoryRecord,depsToAdd,depsToRemove,"Successors").then(function(){return me._collectionSynced(userStoryRecord,dependencies)})},_addPredecessor:function(userStoryRecord,predecessorData,currentProjectRecord,dependenciesParsedData){dependenciesParsedData=dependenciesParsedData||{},dependenciesParsedData.Predecessors=dependenciesParsedData.Predecessors||[];var me=this,dependencies=me._getDependencies(userStoryRecord),cachedPredecessors=dependenciesParsedData.Predecessors,depsToAdd=[],dependencyID=predecessorData.DependencyID;return predecessorData=Ext.clone(predecessorData),predecessorData.Edited=!1,dependencies.Predecessors[dependencyID]={Description:predecessorData.Description,NeededBy:predecessorData.NeededBy,Status:predecessorData.Status,PredecessorItems:predecessorData.PredecessorItems},currentProjectRecord&&userStoryRecord.data.Project.ObjectID!==currentProjectRecord.data.ObjectID||(cachedPredecessors=_.filter(cachedPredecessors,function(cachedPredecessor){return cachedPredecessor.DependencyID!==dependencyID}),cachedPredecessors.push(predecessorData),dependenciesParsedData.Predecessors=cachedPredecessors),_.each(dependencies.Predecessors,function(predecessor){_.each(predecessor.PredecessorItems,function(predecessorItem){predecessorItem.Assigned&&(depsToAdd=_.union(depsToAdd,[predecessorItem.PredecessorUserStoryObjectID]))})}),me._syncCollection(userStoryRecord,depsToAdd,[],"Predecessors").then(function(){return me._collectionSynced(userStoryRecord,dependencies)})},_addSuccessor:function(userStoryRecord,successorData,currentProjectRecord,dependenciesParsedData){dependenciesParsedData=dependenciesParsedData||{},dependenciesParsedData.Successors=dependenciesParsedData.Successors||[];var me=this,dependencies=me._getDependencies(userStoryRecord),cachedSuccessors=dependenciesParsedData.Successors,depsToAdd=[],dependencyID=successorData.DependencyID;return successorData=Ext.clone(successorData),successorData.Edited=!1,dependencies.Successors[dependencyID]={SuccessorUserStoryObjectID:successorData.SuccessorUserStoryObjectID,SuccessorProjectObjectID:successorData.SuccessorProjectObjectID,Description:successorData.Description,NeededBy:successorData.NeededBy,Supported:successorData.Supported,Assigned:successorData.Assigned},currentProjectRecord&&userStoryRecord.data.Project.ObjectID!==currentProjectRecord.data.ObjectID||(cachedSuccessors=_.filter(cachedSuccessors,function(cachedSuccessor){return cachedSuccessor.DependencyID!==dependencyID}),cachedSuccessors.push(successorData),dependenciesParsedData.Successors=cachedSuccessors),_.each(dependencies.Successors,function(successor){depsToAdd=_.union(depsToAdd,[successor.SuccessorUserStoryObjectID])}),me._syncCollection(userStoryRecord,depsToAdd,[],"Successors").then(function(){return me._collectionSynced(userStoryRecord,dependencies)})},_getOldAndNewUserStoryRecords:function(dependencyData,userStoryList){function loadOriginalParent(){return Q(dependencyData.UserStoryObjectID?me._loadUserStory(dependencyData.UserStoryObjectID):null).then(function(oldUserStoryRecord){return newUserStoryRecord=newUserStoryRecord||oldUserStoryRecord,[oldUserStoryRecord,newUserStoryRecord]})}var me=this,newUserStoryRecord=_.find(userStoryList,function(userStory){return userStory.data.FormattedID==dependencyData.UserStoryFormattedID});return newUserStoryRecord?me._loadUserStory(newUserStoryRecord.data.ObjectID).then(function(userStoryRecord){return newUserStoryRecord=userStoryRecord,loadOriginalParent()}):(newUserStoryRecord=null,loadOriginalParent())},_getPredecessorItemArrays:function(localPredecessorData,realPredecessorData){var me=this,addedItemsData=[],updatedItemsData=[],removedItemsData=[],localPredecessorItemsData=localPredecessorData.PredecessorItems||[],realPredecessorItemsData=realPredecessorData?realPredecessorData.PredecessorItems||[]:[];if(realPredecessorItemsData.length){Outer:for(var i=localPredecessorItemsData.length-1;i>=0;--i){for(var j=0;realPredecessorItemsData.length>j;++j)if(localPredecessorItemsData[i].PredecessorItemID===realPredecessorItemsData[j].PredecessorItemID){updatedItemsData.push(realPredecessorItemsData.splice(j,1)[0]);continue Outer}addedItemsData.push(localPredecessorItemsData[i])}removedItemsData=realPredecessorItemsData}else addedItemsData=localPredecessorItemsData;return{added:addedItemsData,updated:updatedItemsData,removed:removedItemsData}},_getAddedPredecessorItemCallbacks:function(predecessorItemsData,predecessorData,successorProjectRecord,projectOIDmap,currentProjectRecord,dependenciesParsedData){var me=this,permissions=me.getContext().getPermissions();return Q.all(_.map(predecessorItemsData,function(predecessorItemData){return function(){var predecessorProjectRecord=projectOIDmap[predecessorItemData.PredecessorProjectObjectID];return permissions.isProjectEditor(predecessorProjectRecord)?me._loadRandomUserStoryFromReleaseTimeframe(predecessorProjectRecord,me.ReleaseRecord).then(function(newUserStory){if(newUserStory){var newSuccessorDependency={DependencyID:predecessorData.DependencyID,SuccessorUserStoryObjectID:predecessorData.UserStoryObjectID,SuccessorProjectObjectID:successorProjectRecord.data.ObjectID,UserStoryObjectID:newUserStory.data.ObjectID,UserStoryFormattedID:"",UserStoryName:"",Description:predecessorData.Description,NeededBy:predecessorData.NeededBy,Supported:predecessorItemData.Supported,Assigned:!1,Edited:!1};return predecessorItemData.PredecessorUserStoryObjectID=newUserStory.data.ObjectID,me._addSuccessor(newUserStory,newSuccessorDependency,currentProjectRecord,dependenciesParsedData)}return Q.reject("Project "+predecessorProjectRecord.data.Name+" has no user stories in this Release, cannot continue")}):Q.reject("You lack permissions to modify project: "+predecessorProjectRecord.data.Name)}}))},_getUpdatedPredecessorItemCallbacks:function(predecessorItemsData,predecessorData,successorProjectRecord,projectOIDmap,currentProjectRecord,dependenciesParsedData){var me=this,permissions=me.getContext().getPermissions();return Q.all(_.map(predecessorItemsData,function(predecessorItemData){return function(){var predecessorProjectRecord=projectOIDmap[predecessorItemData.PredecessorProjectObjectID];if(permissions.isProjectEditor(predecessorProjectRecord)){var updatedSuccessorDependency={DependencyID:predecessorData.DependencyID,SuccessorUserStoryObjectID:predecessorData.UserStoryObjectID,SuccessorProjectObjectID:successorProjectRecord.data.ObjectID,UserStoryObjectID:0,UserStoryFormattedID:"",UserStoryName:"",Description:predecessorData.Description,NeededBy:predecessorData.NeededBy,Supported:predecessorItemData.Supported,Assigned:!1,Edited:!1};return me._loadUserStory(predecessorItemData.PredecessorUserStoryObjectID).then(function(userStory){return userStory?(updatedSuccessorDependency.UserStoryObjectID=userStory.data.ObjectID,updatedSuccessorDependency.UserStoryFormattedID=userStory.data.FormattedID,updatedSuccessorDependency.UserStoryName=userStory.data.Name,updatedSuccessorDependency.Assigned=predecessorItemData.Assigned,me._addSuccessor(userStory,updatedSuccessorDependency,currentProjectRecord,dependenciesParsedData)):me._loadRandomUserStoryFromReleaseTimeframe(predecessorProjectRecord,me.ReleaseRecord).then(function(newUserStory){return newUserStory?(predecessorItemData.PredecessorUserStoryObjectID=newUserStory.data.ObjectID,predecessorItemData.Assigned=!1,updatedSuccessorDependency.UserStoryObjectID=newUserStory.data.ObjectID,updatedSuccessorDependency.UserStoryName="",updatedSuccessorDependency.FormattedID="",updatedSuccessorDependency.Assigned=!1,me._addSuccessor(newUserStory,updatedSuccessorDependency,currentProjectRecord,dependenciesParsedData)):Q.reject("Project "+predecessorProjectRecord.data.Name+" has no user stories in this Release, cannot continue")})})}return Q.reject("You lack permissions to modify project: "+predecessorProjectRecord.data.Name)}}))},_getRemovedPredecessorItemCallbacks:function(predecessorItemsData,predecessorData,successorProjectRecord,projectOIDmap,currentProjectRecord,dependenciesParsedData){var me=this,permissions=me.getContext().getPermissions();return Q.all(_.map(predecessorItemsData,function(predecessorItemData){return function(){var predecessorProjectRecord=projectOIDmap[predecessorItemData.PredecessorProjectObjectID];return permissions.isProjectEditor(predecessorProjectRecord)?me._loadUserStory(predecessorItemData.PredecessorUserStoryObjectID).then(function(userStory){if(userStory){var successorDependency={DependencyID:predecessorData.DependencyID,SuccessorUserStoryObjectID:predecessorData.UserStoryObjectID,SuccessorProjectObjectID:me.ProjectRecord.data.ObjectID,UserStoryObjectID:userStory.data.ObjectID,UserStoryFormattedID:"",UserStoryName:"",Description:"",NeededBy:0,Supported:"",Assigned:predecessorItemData.Assigned,Edited:!1};return me._removeSuccessor(userStory,successorDependency,currentProjectRecord,dependenciesParsedData)}}):Q.reject("You lack permissions to modify project: "+predecessorProjectRecord.data.Name)}}))},_updateSuccessor:function(predecessorUserStory,successorData,predecessorProjectRecord,projectOIDmap,currentProjectRecord,dependenciesParsedData){var me=this,permissions=me.getContext().getPermissions(),successorProjectRecord=projectOIDmap[successorData.SuccessorProjectObjectID];return permissions.isProjectEditor(successorProjectRecord)?me._loadUserStory(successorData.SuccessorUserStoryObjectID).then(function(userStory){if(userStory){var successorsDependencies=me._getDependencies(userStory),successorsDependency=successorsDependencies.Predecessors[successorData.DependencyID];if(successorsDependency){var predecessorData={DependencyID:successorData.DependencyID,UserStoryObjectID:userStory.data.ObjectID,UserStoryFormattedID:userStory.data.FormattedID,UserStoryName:userStory.data.Name,Description:successorsDependency.Description,NeededBy:successorsDependency.NeededBy,Status:successorsDependency.Status,PredecessorItems:successorsDependency.PredecessorItems||[],Edited:!1},predecessorItem=_.find(predecessorData.PredecessorItems,function(predecessorItem){return predecessorItem.PredecessorProjectObjectID==predecessorProjectRecord.data.ObjectID});return predecessorItem?(predecessorItem.PredecessorUserStoryObjectID=predecessorUserStory.data.ObjectID,predecessorItem.Supported=successorData.Supported,predecessorItem.Assigned=successorData.Assigned,me._addPredecessor(userStory,predecessorData,currentProjectRecord,dependenciesParsedData)):Q.reject({SuccessorDeletedDependency:!0,message:"Successor removed this dependency."})}return Q.reject({SuccessorDeletedDependency:!0,message:"Successor removed this dependency."})}return Q.reject({SuccessorDeletedDependency:!0,message:"Successor UserStory has been deleted."})}):Q.reject("You lack permissions to modify project: "+successorProjectRecord.data.Name)}})})();
                (function(){var Ext=window.Ext4||window.Ext,RALLY_MAX_STRING_SIZE=32768;Ext.define("RisksDepsTracking",{extend:"IntelRallyApp",mixins:["WindowListener","PrettyAlert","IframeResize","IntelWorkweek","AsyncQueue","ParallelLoader","UserAppsPreference","RisksLib","DependenciesLib"],layout:{type:"vbox",align:"stretch",pack:"start"},items:[{xtype:"container",height:45,id:"navbox",layout:{type:"hbox",align:"stretch",pack:"start"},items:[{xtype:"container",flex:3,id:"navboxLeft",layout:{type:"hbox"}},{xtype:"container",flex:2,id:"navboxRight",layout:{type:"hbox",pack:"end"}}]}],minWidth:1100,_userAppsPref:"intel-SAFe-apps-preference",_loadPortfolioItemsOfTypeInRelease:function(portfolioProject,type){if(!portfolioProject||!type)return Q.reject("Invalid arguments: OPIOT");var me=this,store=Ext.create("Rally.data.wsapi.Store",{model:"PortfolioItem/"+type,limit:1/0,disableMetaChangeEvent:!0,remoteSort:!1,fetch:me._portfolioItemFields,filters:[{property:"Release.Name",value:me.ReleaseRecord.data.Name}],context:{project:portfolioProject.data._ref,projectScopeDown:!0,projectScopeUp:!1}});return me._reloadStore(store)},_loadPortfolioItems:function(){var me=this;return Q.all(_.map(me.PortfolioItemTypes,function(type,ordinal){return(ordinal?me._loadPortfolioItemsOfType(me.TrainPortfolioProject,type):me._loadPortfolioItemsOfTypeInRelease(me.TrainPortfolioProject,type)).then(function(portfolioStore){return{ordinal:ordinal,store:portfolioStore}})})).then(function(items){var orderedPortfolioItemStores=_.sortBy(items,function(item){return item.ordinal});me.PortfolioItemStore=orderedPortfolioItemStores[0].store,me.PortfolioItemMap={},_.each(me.PortfolioItemStore.getRange(),function(lowPortfolioItem){for(var ordinal=0,parentPortfolioItem=lowPortfolioItem,getParentRecord=function(child,parentList){return _.find(parentList,function(parent){return child.data.Parent&&parent.data.ObjectID==child.data.Parent.ObjectID})};orderedPortfolioItemStores.length-1>ordinal&&parentPortfolioItem;)parentPortfolioItem=getParentRecord(parentPortfolioItem,orderedPortfolioItemStores[ordinal+1].store.getRange()),++ordinal;ordinal===orderedPortfolioItemStores.length-1&&parentPortfolioItem&&(me.PortfolioItemMap[lowPortfolioItem.data.ObjectID]=parentPortfolioItem.data.Name)})})},_getUserStoryFilter:function(){var me=this,lowestPortfolioItem=me.PortfolioItemTypes[0];return Ext.create("Rally.data.wsapi.Filter",{property:"Release.Name",value:me.ReleaseRecord.data.Name}).or(Ext.create("Rally.data.wsapi.Filter",{property:"Release.ObjectID",value:null}).and(Ext.create("Rally.data.wsapi.Filter",{property:lowestPortfolioItem+".Release.Name",value:me.ReleaseRecord.data.Name})))},_loadUserStories:function(){var me=this,lowestPortfolioItem=me.PortfolioItemTypes[0],config={model:me.UserStory,url:"https://rally1.rallydev.com/slm/webservice/v2.0/HierarchicalRequirement",params:{pagesize:200,query:""+me._getUserStoryFilter(),fetch:["Name","ObjectID","Project","Release","FormattedID",lowestPortfolioItem,"c_Dependencies"].join(","),project:me.TrainRecord.data._ref,projectScopeDown:!0,projectScopeUp:!1}};return me._parallelLoadWsapiStore(config).then(function(store){return me.UserStoryStore=store,store})},_parseRisksFromPortfolioItem:function(portfolioItemRecord){var me=this,array=[],risks=me._getRisks(portfolioItemRecord),PortfolioItemObjectID=portfolioItemRecord.data.ObjectID,PortfolioItemFormattedID=portfolioItemRecord.data.FormattedID,PortfolioItemName=portfolioItemRecord.data.Name,TopPortfolioItemName=me.PortfolioItemMap[portfolioItemRecord.data.ObjectID]||"";return _.each(risks,function(risksData,projectID){_.each(risksData,function(riskData,riskID){array.push({RiskID:riskID,PortfolioItemObjectID:PortfolioItemObjectID,PortfolioItemFormattedID:PortfolioItemFormattedID,PortfolioItemName:PortfolioItemName,TopPortfolioItemName:TopPortfolioItemName,ProjectObjectID:projectID,Description:riskData.Description,Impact:riskData.Impact,MitigationPlan:riskData.MitigationPlan,Urgency:riskData.Urgency,Status:riskData.Status,Contact:riskData.Contact,Checkpoint:riskData.Checkpoint,Edited:!1})})}),array},_parseRisksData:function(){var me=this,array=[];return _.each(me.PortfolioItemStore.getRecords(),function(portfolioItemRecord){array=array.concat(me._parseRisksFromPortfolioItem(portfolioItemRecord))}),array},_spliceRiskFromList:function(riskID,risksData){for(var i=0;risksData.length>i;++i)if(risksData[i].RiskID==riskID)return risksData.splice(i,1)[0]},_getRealRiskData:function(oldPortfolioItemRecord,riskID){var me=this,realRisksData;return realRisksData=oldPortfolioItemRecord?me._parseRisksFromPortfolioItem(oldPortfolioItemRecord):[],me._spliceRiskFromList(riskID,realRisksData)||null},_isUserStoryInRelease:function(userStoryRecord,releaseRecord){var me=this,lowestPortfolioItem=me.PortfolioItemTypes[0];return(userStoryRecord.data.Release||{}).Name===releaseRecord.data.Name||!userStoryRecord.data.Release&&((userStoryRecord.data[lowestPortfolioItem]||{}).Release||{}).Name===releaseRecord.data.Name},_spliceDependencyFromList:function(dependencyID,dependencyList){for(var i=0;dependencyList.length>i;++i)if(dependencyList[i].DependencyID==dependencyID)return dependencyList.splice(i,1)[0]},_parseDependenciesFromUserStory:function(userStoryRecord){var me=this,lowestPortfolioItem=me.PortfolioItemTypes[0],dependencies=me._getDependencies(userStoryRecord),inputPredecessors=dependencies.Predecessors,outputPredecessors=[],UserStoryObjectID=userStoryRecord.data.ObjectID,UserStoryFormattedID=userStoryRecord.data.FormattedID,UserStoryName=userStoryRecord.data.Name,TopPortfolioItemName=me.PortfolioItemMap[(userStoryRecord.data[lowestPortfolioItem]||{}).ObjectID]||"",ProjectObjectID=(userStoryRecord.data.Project||{}).ObjectID||0;return me._isUserStoryInRelease(userStoryRecord,me.ReleaseRecord)&&_.each(inputPredecessors,function(predecessorDependency,dependencyID){outputPredecessors.push({DependencyID:dependencyID,UserStoryObjectID:UserStoryObjectID,UserStoryFormattedID:UserStoryFormattedID,UserStoryName:UserStoryName,TopPortfolioItemName:TopPortfolioItemName,ProjectObjectID:ProjectObjectID,Description:predecessorDependency.Description,NeededBy:predecessorDependency.NeededBy,Status:predecessorDependency.Status,PredecessorItems:predecessorDependency.PredecessorItems||[],Edited:!1})}),{Predecessors:outputPredecessors,Successors:[]}},_parseDependenciesData:function(userStories){var me=this,predecessors=[],successors=[];return _.each(userStories,function(userStoryRecord){var dependenciesData=me._parseDependenciesFromUserStory(userStoryRecord);predecessors=predecessors.concat(dependenciesData.Predecessors),successors=successors.concat(dependenciesData.Successors)}),{Predecessors:predecessors,Successors:successors}},_getRealDependencyData:function(oldUserStoryRecord,dependencyID,type){var me=this,realDependencyData;return realDependencyData=oldUserStoryRecord?me._parseDependenciesFromUserStory(oldUserStoryRecord)[type]:[],me._spliceDependencyFromList(dependencyID,realDependencyData)||null},_hydrateDependencyUserStories:function(dependenciesParsedData){var me=this,storyOIDsToHydrate=[],dependenciesHydratedUserStories={};return _.each(dependenciesParsedData.Predecessors,function(predecessor){_.each(predecessor.PredecessorItems,function(predecessorItem){storyOIDsToHydrate.push(predecessorItem.PredecessorUserStoryObjectID)})}),Q.all(_.map(storyOIDsToHydrate,function(storyOID){return me._loadUserStory(storyOID).then(function(userStory){userStory&&(dependenciesHydratedUserStories[storyOID]=userStory)})})).then(function(){return dependenciesHydratedUserStories})},_htmlEscape:function(str){return(str+"").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},_getDirtyType:function(localRecord,realDataFromServer){return realDataFromServer?localRecord.data.Edited?"Edited":"Unchanged":localRecord.data.Edited?"New":"Deleted"},_updateUserStoryColumnStores:function(){var me=this,userStories=me.UserStoriesInRelease;me.UserStoryFIDStore&&(me.UserStoryFIDStore.removeAll(),_.each(userStories,function(userStory){me.UserStoryFIDStore.add({FormattedID:userStory.data.FormattedID})})),me.UserStoryNameStore&&(me.UserStoryNameStore.removeAll(),_.each(userStories,function(userStory){me.UserStoryNameStore.add({Name:userStory.data.Name})}))},_updatePortfolioItemColumnStores:function(){var me=this,portfolioItems=me.PortfolioItemStore.getRange();me.PortfolioItemFIDStore&&(me.PortfolioItemFIDStore.removeAll(),_.each(portfolioItems,function(portfolioItem){me.PortfolioItemFIDStore.add({FormattedID:portfolioItem.data.FormattedID})})),me.PortfolioItemNameStore&&(me.PortfolioItemNameStore.removeAll(),_.each(portfolioItems,function(portfolioItem){me.PortfolioItemNameStore.add({Name:portfolioItem.data.Name})}))},_isEditing:function(store){return store?_.some(store.getRange(),function(record){return record.data.Edited}):!1},_showGrids:function(){var me=this;me.RisksGrid||(me._loadRisksGrid(),me._loadDependenciesGrids())},_checkForDuplicates:function(){var me=this,deferred=Q.defer(),duplicateRisks=_.filter(_.groupBy(me.RisksParsedData,function(risk){return risk.RiskID}),function(list,riskID){return list.length>1}),duplicatePredecessors=_.filter(_.groupBy(me.DependenciesParsedData.Predecessors,function(dependency){return dependency.DependencyID}),function(list,dependencyID){return list.length>1});return duplicateRisks.length||duplicatePredecessors.length?me._loadResolveDuplicatesModal(duplicateRisks,duplicatePredecessors).then(function(){return me._clearEverything(),me.setLoading("Loading Data"),me._reloadStores()}).then(function(){return me._updateGrids()}).then(function(){me.setLoading(!1)}).then(function(){deferred.resolve()}).fail(function(reason){deferred.reject(reason)}).done():deferred.resolve(),deferred.promise},_updateGrids:function(){var me=this,promises=[];return isEditingRisks=me._isEditing(me.CustomRisksStore),isEditingDeps=me._isEditing(me.CustomPredecessorStore),!isEditingRisks&&me.PortfolioItemStore&&(me.RisksParsedData=me._parseRisksData(),me._updatePortfolioItemColumnStores(),me.CustomRisksStore&&me.CustomRisksStore.intelUpdate()),!isEditingDeps&&me.UserStoryStore&&me.PortfolioItemStore&&(me.UserStoriesInRelease=_.filter(me.UserStoryStore.getRange(),function(userStoryRecord){return me._isUserStoryInRelease(userStoryRecord,me.ReleaseRecord)}),me.DependenciesParsedData=me._parseDependenciesData(me.UserStoryStore.getRange()),promises.push(me._hydrateDependencyUserStories(me.DependenciesParsedData).then(function(dependenciesHydratedUserStories){me.DependenciesHydratedUserStories=dependenciesHydratedUserStories,me._updateUserStoryColumnStores(),me.CustomPredecessorStore&&me.CustomPredecessorStore.intelUpdate()}))),Q.all(promises)},_reloadStores:function(){var me=this,lowestPortfolioItem=me.PortfolioItemTypes[0],isEditingRisks=me._isEditing(me.CustomRisksStore),isEditingDeps=me._isEditing(me.CustomPredecessorStore),promises=[];return isEditingRisks||promises.push(me._loadPortfolioItems()),isEditingDeps||promises.push(me._loadUserStories()),Q.all(promises)},_clearEverything:function(){var me=this;me.PortfolioItemMap={},me.UserStoryStore=void 0,me.PortfolioItemStore=void 0,me.PredecessorGrid=void 0,me.RisksGrid=void 0,me.CustomPredecessorStore=void 0,me.CustomRisksStore=void 0;for(var toRemove=me.down("#navbox").next(),tmp;toRemove;)tmp=toRemove.next(),toRemove.up().remove(toRemove),toRemove=tmp},_reloadEverything:function(){var me=this;me._clearEverything(),me.setLoading("Loading Data"),me.ReleasePicker||(me._loadReleasePicker(),me._loadManualRefreshButton()),me._enqueue(function(unlockFunc){me._reloadStores().then(function(){return me._updateGrids()}).then(function(){return me._checkForDuplicates()}).then(function(){return me._showGrids()}).fail(function(reason){me._alert("ERROR",reason||"")}).then(function(){unlockFunc(),me.setLoading(!1)}).done()},"Queue-Main")},_setLoadingMasks:function(){var me=this,message="Refreshing Data",isEditingRisks=me._isEditing(me.CustomRisksStore),isEditingDeps=me._isEditing(me.CustomPredecessorStore);me.RisksGrid&&!isEditingRisks&&me.RisksGrid.setLoading(message),me.PredecessorGrid&&!isEditingDeps&&me.PredecessorGrid.setLoading(message)},_removeLoadingMasks:function(){var me=this,isEditingRisks=me._isEditing(me.CustomRisksStore),isEditingDeps=me._isEditing(me.CustomPredecessorStore);me.RisksGrid&&!isEditingRisks&&me.RisksGrid.setLoading(!1),me.PredecessorGrid&&!isEditingDeps&&me.PredecessorGrid.setLoading(!1)},_refreshDataFunc:function(){var me=this;me._setLoadingMasks(),me._enqueue(function(unlockFunc){me._reloadStores().then(function(){return me._updateGrids()}).then(function(){return me._checkForDuplicates()}).then(function(){return me._showGrids()}).fail(function(reason){me._alert("ERROR",reason||"")}).then(function(){unlockFunc(),me._removeLoadingMasks()}).done()},"Queue-Main")},launch:function(){var me=this;return me.setLoading("Loading Configuration"),me._initDisableResizeHandle(),me._initFixRallyDashboard(),me.getContext().getPermissions().isProjectEditor(me.getContext().getProject())?(me._configureIntelRallyApp().then(function(){var scopeProject=me.getContext().getProject();return me._loadProject(scopeProject.ObjectID)}).then(function(scopeProjectRecord){return me.ProjectRecord=scopeProjectRecord,Q.all([me._loadProjectsWithTeamMembers().then(function(projectsWithTeamMembers){me.ProjectsWithTeamMembers=projectsWithTeamMembers,me.ProjectNames=_.map(projectsWithTeamMembers,function(project){return{Name:project.data.Name}})}),me._projectInWhichTrain(me.ProjectRecord).then(function(trainRecord){return trainRecord&&me.ProjectRecord.data.ObjectID==trainRecord.data.ObjectID?(me.TrainRecord=trainRecord,me._loadTrainPortfolioProject(me.TrainRecord).then(function(trainPortfolioProject){me.TrainPortfolioProject=trainPortfolioProject})):Q.reject("You are not scoped to a train")}),me._loadAppsPreference().then(function(appsPref){me.AppsPref=appsPref;var twelveWeeks=72576e5;return me._loadReleasesAfterGivenDate(me.ProjectRecord,1*new Date-twelveWeeks)}).then(function(releaseRecords){me.ReleaseRecords=releaseRecords;var currentRelease=me._getScopedRelease(releaseRecords,me.ProjectRecord.data.ObjectID,me.AppsPref);return currentRelease?(me.ReleaseRecord=currentRelease,me.WorkweekData=me._getWorkWeeksForDropdown(currentRelease.data.ReleaseStartDate,currentRelease.data.ReleaseDate),void 0):Q.reject("This project has no releases.")})])}).then(function(){return me._reloadEverything()}).fail(function(reason){me.setLoading(!1),me._alert("ERROR",reason||"")}).done(),void 0):(me.setLoading(!1),me._alert("ERROR","You do not have permissions to edit this project"),void 0)},_releasePickerSelected:function(combo,records){var me=this,pid=me.ProjectRecord.data.ObjectID;me.ReleaseRecord.data.Name!==records[0].data.Name&&(me.setLoading("Saving Preference"),me.ReleaseRecord=_.find(me.ReleaseRecords,function(rr){return rr.data.Name==records[0].data.Name}),me.WorkweekData=me._getWorkWeeksForDropdown(me.ReleaseRecord.data.ReleaseStartDate,me.ReleaseRecord.data.ReleaseDate),"object"!=typeof me.AppsPref.projs[pid]&&(me.AppsPref.projs[pid]={}),me.AppsPref.projs[pid].Release=me.ReleaseRecord.data.ObjectID,me._saveAppsPreference(me.AppsPref).then(function(){me._reloadEverything()}).fail(function(reason){me._alert("ERROR",reason||"")}).then(function(){me.setLoading(!1)}).done())},_loadReleasePicker:function(){var me=this;me.ReleasePicker=me.down("#navboxLeft").add({xtype:"intelreleasepicker",id:"releasePicker",releases:me.ReleaseRecords,currentRelease:me.ReleaseRecord,listeners:{change:function(combo,newval,oldval){0===newval.length&&combo.setValue(oldval)},select:me._releasePickerSelected.bind(me)}})},_loadManualRefreshButton:function(){var me=this;me.down("#navboxRight").add({xtype:"button",id:"manualRefreshButton",text:"Refresh Data",width:100,listeners:{click:me._refreshDataFunc.bind(me)}})},_loadResolveDuplicatesModal:function(duplicateRisks,duplicatePredecessors){var me=this,deferred=Q.defer(),defaultRenderer=function(val){return val||"-"},modal=Ext.create("Ext.window.Window",{modal:!0,closable:!1,title:"ERROR: Duplicate Risks and/or Dependencies!",cls:"duplicates-modal",overflowY:"scroll",resizable:!0,height:.9*me.getHeight()>>0,width:Math.min(900,.9*me.getWidth()>>0),y:5,items:[{xtype:"container",html:"<p>Use the checkboxes to select which of the duplicates you want to keep. You have to keep exactly 1 of the duplicates. When you have finished, click Done.</p><br/>",manageHeight:!1}].concat(duplicateRisks.length?[{xtype:"container",html:'<h2 class="grid-group-header">Duplicate Risks</h2>',manageHeight:!1}].concat(_.map(duplicateRisks,function(risksOfOneID){return{xtype:"rallygrid",cls:"risksdeps-grid duplicate-risks-grid rally-grid",columnCfgs:[{text:"#",dataIndex:"PortfolioItemFormattedID",width:80,editor:!1,resizable:!1,draggable:!1,sortable:!0,renderer:defaultRenderer},{text:me.PortfolioItemTypes[0],dataIndex:"PortfolioItemName",flex:1,editor:!1,resizable:!1,draggable:!1,sortable:!0,renderer:defaultRenderer},{text:"Team",dataIndex:"ProjectObjectID",flex:1,minWidth:100,editor:!1,resizable:!1,draggable:!1,sortable:!0,renderer:function(projectObjectID){return((me.ProjectsWithTeamMembers[projectObjectID]||{}).data||{}).Name||"?"}},{text:"Risk Description (If This...)",dataIndex:"Description",flex:1,editor:!1,resizable:!1,draggable:!1,sortable:!1,renderer:defaultRenderer},{text:"Impact (Then this...)",dataIndex:"Impact",flex:1,resizable:!1,draggable:!1,sortable:!1,editor:!1,renderer:defaultRenderer},{text:"Mitigation Plan",dataIndex:"MitigationPlan",flex:1,resizable:!1,draggable:!1,sortable:!1,editor:!1,renderer:defaultRenderer},{text:"Status",dataIndex:"Status",width:100,tooltip:"(ROAM)",tooltipType:"title",editor:!1,resizable:!1,draggable:!1,sortable:!0,renderer:function(val,meta){return meta.tdCls+="Undefined"===val?" risks-grid-error-cell":"",val||"-"}},{text:"Contact",dataIndex:"Contact",flex:1,editor:!1,sortable:!1,resizable:!1,draggable:!1,renderer:defaultRenderer},{text:"Checkpoint",dataIndex:"Checkpoint",width:90,resizable:!1,draggable:!1,editor:!1,sortable:!0,renderer:function(date){return date?"ww"+me._getWorkweek(date):"-"}}],selModel:Ext.create("Ext.selection.CheckboxModel",{mode:"SINGLE",allowDeselect:!1}),listeners:{viewready:function(){this.getSelectionModel().select(0)}},manageHeight:!1,sortableColumns:!1,showRowActionsColumn:!1,showPagingToolbar:!1,enableEditing:!1,store:Ext.create("Rally.data.custom.Store",{data:risksOfOneID})}})):[]).concat(duplicatePredecessors.length?[{xtype:"container",html:'<h2 class="grid-group-header">Duplicate Predecessors</h2>',manageHeight:!1}].concat(_.map(duplicatePredecessors,function(predecessorsOfOneID){return{xtype:"rallygrid",cls:"risksdeps-grid duplicate-predecessors-grid rally-grid",columnCfgs:[{text:"#",dataIndex:"UserStoryFormattedID",width:90,resizable:!1,draggable:!1,sortable:!0,editor:!1,renderer:defaultRenderer},{text:"UserStory",dataIndex:"UserStoryName",flex:1,resizable:!1,draggable:!1,sortable:!0,editor:!1,renderer:defaultRenderer},{text:"Team",dataIndex:"ProjectObjectID",flex:1,minWidth:100,editor:!1,resizable:!1,draggable:!1,sortable:!0,renderer:function(projectObjectID){return((me.ProjectsWithTeamMembers[projectObjectID]||{}).data||{}).Name||"?"}},{text:"Dependency Description",dataIndex:"Description",flex:1,resizable:!1,draggable:!1,sortable:!1,editor:!1,renderer:defaultRenderer},{text:"Needed By",dataIndex:"NeededBy",width:90,resizable:!1,draggable:!1,sortable:!0,editor:!1,renderer:function(date){return date?"ww"+me._getWorkweek(date):"-"}},{text:"Teams Depended On",dataIndex:"DependencyID",xtype:"fastgridcolumn",html:'<div class="predecessor-items-grid-header" style="width:10px !important;"></div><div class="predecessor-items-grid-header" style="width:110px !important;">Team Name</div><div class="predecessor-items-grid-header" style="width:95px  !important;">Supported</div><div class="predecessor-items-grid-header" style="width:70px  !important;">#</div><div class="predecessor-items-grid-header" style="width:130px !important;">User Story</div>',width:420,resizable:!1,draggable:!1,sortable:!1,renderer:function(dependencyID,meta,record,rowIndex){var swallowEventHandler={element:"el",fn:function(a){a.stopPropagation()}},predecessorItemColumnCfgs=[{dataIndex:"PredecessorProjectObjectID",width:115,resizable:!1,renderer:function(val,meta){var projectRecord=me.ProjectsWithTeamMembers[val];return val&&projectRecord?projectRecord.data.Name:"-"},editor:!1},{dataIndex:"Supported",width:80,resizable:!1,editor:!1,renderer:function(val,meta){return"No"==val?meta.tdCls="predecessor-item-not-supported-cell":"Yes"==val&&(meta.tdCls="predecessor-item-supported-cell"),val}},{dataIndex:"PredecessorUserStoryObjectID",width:75,resizable:!1,editor:!1,renderer:function(userStoryObjectID,meta,predecessorItemRecord){if(predecessorItemRecord.data.Assigned){var userStory=me.DependenciesHydratedUserStories[userStoryObjectID];return userStory?userStory.data.FormattedID:"?"}return"-"}},{dataIndex:"PredecessorUserStoryObjectID",width:140,resizable:!1,editor:!1,renderer:function(userStoryObjectID,meta,predecessorItemRecord){if(predecessorItemRecord.data.Assigned){var userStory=me.DependenciesHydratedUserStories[userStoryObjectID];return userStory?userStory.data.Name:"?"}return"-"}}];return{xtype:"rallygrid",cls:"risksdeps-grid duplicate-predecessor-items-grid rally-grid",viewConfig:{stripeRows:!1},width:420,manageHeight:!1,columnCfgs:predecessorItemColumnCfgs,listeners:{mousedown:swallowEventHandler,mousemove:swallowEventHandler,mouseout:swallowEventHandler,mouseover:swallowEventHandler,mouseup:swallowEventHandler,mousewheel:swallowEventHandler,scroll:swallowEventHandler,click:swallowEventHandler,dblclick:swallowEventHandler,contextmenu:swallowEventHandler,selectionchange:function(){this.getSelectionModel().deselectAll()}},rowLines:!1,disableSelection:!0,scroll:!1,hideHeaders:!0,showRowActionsColumn:!1,showPagingToolbar:!1,enableEditing:!1,store:Ext.create("Rally.data.custom.Store",{data:predecessorsOfOneID[rowIndex].PredecessorItems})}}}],selModel:Ext.create("Ext.selection.CheckboxModel",{mode:"SINGLE",allowDeselect:!1}),listeners:{viewready:function(){this.getSelectionModel().select(0)}},manageHeight:!1,sortableColumns:!1,showRowActionsColumn:!1,showPagingToolbar:!1,enableEditing:!1,store:Ext.create("Rally.data.custom.Store",{data:predecessorsOfOneID})}})):[]).concat([{xtype:"button",cls:"done-button",text:"Done",handler:function(){var grids=Ext.ComponentQuery.query("rallygrid",modal),riskGrids=_.filter(grids,function(grid){return grid.hasCls("duplicate-risks-grid")}),predecessorGrids=_.filter(grids,function(grid){return grid.hasCls("duplicate-predecessors-grid")});modal.setLoading("Removing Duplicates"),Q.all([Q.all(_.map(riskGrids,function(grid){var riskToKeep=grid.getSelectionModel().getSelection()[0],risksToDelete=_.filter(grid.store.getRange(),function(item){return item.id!=riskToKeep.id});return Q.all(_.map(risksToDelete,function(riskRecord){var deferred=Q.defer(),projectRecord=me.ProjectsWithTeamMembers[riskRecord.data.ProjectObjectID];return me._enqueue(function(unlockFunc){me._loadPortfolioItemByOrdinal(riskRecord.data.PortfolioItemObjectID,0).then(function(oldPortfolioItemRecord){var realRiskData=me._getRealRiskData(oldPortfolioItemRecord,riskRecord.data.RiskID);if(realRiskData)return me._removeRisk(oldPortfolioItemRecord,realRiskData,projectRecord,me.RisksParsedData)}).then(function(){deferred.resolve()}).fail(function(reason){deferred.reject(reason)}).then(function(){unlockFunc()}).done()},"Queue-"+riskRecord.data.PortfolioItemObjectID),deferred.promise}))})),Q.all(_.map(predecessorGrids,function(grid){var predecessorToKeep=grid.getSelectionModel().getSelection()[0],predecessorsToRemove=_.filter(grid.store.getRange(),function(item){return item.id!=predecessorToKeep.id});return Q.all(_.map(predecessorsToRemove,function(predecessorRecord){var deferred=Q.defer(),projectRecord=me.ProjectsWithTeamMembers[predecessorRecord.data.ProjectObjectID];return me._enqueue(function(unlockFunc){me._getOldAndNewUserStoryRecords(predecessorRecord.data,me.UserStoriesInRelease).then(function(records){var oldUserStoryRecord=records[0],realPredecessorData=me._getRealDependencyData(oldUserStoryRecord,predecessorRecord.data.DependencyID,"Predecessors");if(realPredecessorData)return me._getRemovedPredecessorItemCallbacks(realPredecessorData.PredecessorItems,realPredecessorData,projectRecord,me.ProjectsWithTeamMembers,null,me.DependenciesParsedData).then(function(removedCallbacks){var promise=Q();return _.each(removedCallbacks,function(callback){promise=promise.then(callback)}),promise.then(function(){return me._removePredecessor(oldUserStoryRecord,realPredecessorData,null,me.DependenciesParsedData)})})}).then(function(){deferred.resolve()}).fail(function(reason){deferred.reject(reason)}).then(function(){unlockFunc()}).done()},"Queue-Dependencies"),deferred.promise})).then(function(){var deferred=Q.defer(),projectRecord=me.ProjectsWithTeamMembers[predecessorToKeep.data.ProjectObjectID];return me._enqueue(function(unlockFunc){me._getOldAndNewUserStoryRecords(predecessorToKeep.data,me.UserStoriesInRelease).then(function(records){var oldUserStoryRecord=records[0],realPredecessorData=me._getRealDependencyData(oldUserStoryRecord,predecessorToKeep.data.DependencyID,"Predecessors");if(realPredecessorData)return me._getAddedPredecessorItemCallbacks(realPredecessorData.PredecessorItems,realPredecessorData,projectRecord,me.ProjectsWithTeamMembers,null,me.DependenciesParsedData).then(function(addedCallbacks){var promise=Q();return _.each(addedCallbacks,function(callback){promise=promise.then(callback)}),promise.then(function(){return me._addPredecessor(oldUserStoryRecord,realPredecessorData,null,me.DependenciesParsedData)})})}).then(function(){deferred.resolve()}).fail(function(reason){deferred.reject(reason)}).then(function(){unlockFunc()}).done()},"Queue-Dependencies"),deferred.promise})}))]).then(function(){modal.destroy(),deferred.resolve()}).fail(function(reason){modal.destroy(),deferred.reject(reason)}).done()}}])});return setTimeout(function(){modal.show()},10),deferred.promise},_loadRisksGrid:function(){function riskGridFilter(riskRecord){if(filterFID&&riskRecord.data.PortfolioItemFormattedID!=filterFID)return!1;if(filterName&&riskRecord.data.PortfolioItemName!=filterName)return!1;if(filterTopPortfolioItem&&riskRecord.data.TopPortfolioItemName!=filterTopPortfolioItem)return!1;if(filterTeam&&((me.ProjectsWithTeamMembers[riskRecord.data.ProjectObjectID]||{}).data||{}).Name!=filterTeam)return!1;if(filterStatus&&riskRecord.data.Status!=filterStatus)return!1;if(filterUrgency){if("Undefined"==filterUrgency&&riskRecord.data.Urgency&&riskRecord.data.Urgency!=filterUrgency)return!1;if("Undefined"!=filterUrgency&&riskRecord.data.Urgency!=filterUrgency)return!1}return filterCheckpoint&&1*me._roundDateDownToWeekStart(riskRecord.data.Checkpoint)!=filterCheckpoint?!1:!0}function filterRisksRowsByFn(fn){_.each(me.CustomRisksStore.getRange(),function(item,index){fn(item)?me.RisksGrid.view.removeRowCls(index,"risksdeps-hidden-grid-row"):me.RisksGrid.view.addRowCls(index,"risksdeps-hidden-grid-row")})}function removeFilters(){filterFID=null,filterName=null,filterTopPortfolioItem=null,filterTeam=null,filterStatus=null,filterUrgency=null,filterCheckpoint=null,filterRisksRowsByFn(function(){return!0}),Ext.getCmp("risk-fid-filter").setValue("All"),Ext.getCmp("risk-name-filter").setValue("All"),Ext.getCmp("risk-top-portfolioitem-filter").setValue("All"),Ext.getCmp("risk-team-filter").setValue("All"),Ext.getCmp("risk-status-filter").setValue("All"),Ext.getCmp("risk-urgency-filter").setValue("All"),Ext.getCmp("risk-checkpoint-filter").setValue("All")}function getFIDfilterOptions(){return[{FormattedID:"All"}].concat(_.map(_.sortBy(_.union(_.map(me.CustomRisksStore.getRange(),function(r){return r.data.PortfolioItemFormattedID})),function(f){return f}),function(f){return{FormattedID:f}}))}function getNameFilterOptions(){return[{Name:"All"}].concat(_.map(_.sortBy(_.union(_.map(me.CustomRisksStore.getRange(),function(r){return r.data.PortfolioItemName})),function(f){return f}),function(n){return{Name:n}}))}function getTopPortfolioItemFilterOptions(){return[{PortfolioItemName:"All"}].concat(_.map(_.sortBy(_.union(_.values(me.PortfolioItemMap)),function(p){return p}),function(p){return{PortfolioItemName:p}}))}function getTeamFilterOptions(){return[{Team:"All"}].concat(_.map(_.sortBy(_.union(_.map(me.CustomRisksStore.getRange(),function(r){return((me.ProjectsWithTeamMembers[r.data.ProjectObjectID]||{}).data||{}).Name})),function(t){return t}),function(t){return{Team:t}}))}function getCheckpointFilterOptions(){return[{DateVal:0,Workweek:"All"}].concat(_.map(_.sortBy(_.union(_.map(me.CustomRisksStore.getRange(),function(risk){return 1*me._roundDateDownToWeekStart(risk.data.Checkpoint)})),function(date){return date}),function(date){return{DateVal:date,Workweek:"ww"+me._getWorkweek(date)}}))}function updateFilterOptions(){var checkpointStore=Ext.getCmp("risk-checkpoint-filter").getStore();checkpointStore.removeAll(),checkpointStore.add(getCheckpointFilterOptions())}var me=this,defaultRenderer=function(val){return val||"-"};me.PortfolioItemFIDStore=Ext.create("Ext.data.Store",{fields:["FormattedID"],data:_.map(me.PortfolioItemStore.getRange(),function(item){return{FormattedID:item.data.FormattedID}}),sorters:{property:"FormattedID"}}),me.PortfolioItemNameStore=Ext.create("Ext.data.Store",{fields:["Name"],data:_.map(me.PortfolioItemStore.getRange(),function(item){return{Name:item.data.Name}}),sorters:{property:"Name"}}),me.CustomRisksStore=Ext.create("Intel.data.FastStore",{data:Ext.clone(me.RisksParsedData),autoSync:!0,model:"IntelRiskForTracking",limit:1/0,disableMetaChangeEvent:!0,proxy:{type:"fastsessionproxy",id:"RiskProxy"+Math.random()},sorters:[function riskSorter(o1,o2){return o1.data.RiskID>o2.data.RiskID?-1:1}],intelUpdate:function(){var riskStore=me.CustomRisksStore,riskRecords=riskStore.getRange(),realRisksData=me.RisksParsedData.slice(),remoteChanged=!1;riskStore.suspendEvents(!0),_.each(riskRecords,function(riskRecord){var realRiskData=me._spliceRiskFromList(riskRecord.data.RiskID,realRisksData),dirtyType=me._getDirtyType(riskRecord,realRiskData);"New"===dirtyType||"Edited"===dirtyType||("Deleted"==dirtyType?riskStore.remove(riskRecord):(_.each(realRiskData,function(value,field){_.isEqual(riskRecord.data[field],value)||(remoteChanged=!0)}),remoteChanged&&(riskRecord.beginEdit(),_.each(realRiskData,function(value,field){riskRecord.set(field,realRiskData[field])}),riskRecord.endEdit())))}),_.each(realRisksData,function(realRiskData){riskStore.add(Ext.create("IntelRiskForTracking",Ext.clone(realRiskData)))}),riskStore.resumeEvents()}});var filterFID=null,filterName=null,filterTopPortfolioItem=null,filterTeam=null,filterStatus=null,filterUrgency=null,filterCheckpoint=null,columnCfgs=[{text:"#",dataIndex:"PortfolioItemFormattedID",width:80,editor:!1,resizable:!1,draggable:!1,sortable:!0,renderer:defaultRenderer,layout:"hbox",items:[{id:"risk-fid-filter",xtype:"intelcombobox",flex:1,store:Ext.create("Ext.data.Store",{fields:["FormattedID"],data:getFIDfilterOptions()}),displayField:"FormattedID",value:"All",listeners:{select:function(combo,selected){filterFID="All"==selected[0].data.FormattedID?null:selected[0].data.FormattedID,filterRisksRowsByFn(riskGridFilter)}}},{xtype:"container",width:5}]},{text:me.PortfolioItemTypes[0],dataIndex:"PortfolioItemName",flex:1,editor:!1,resizable:!1,draggable:!1,sortable:!0,renderer:defaultRenderer,layout:"hbox",items:[{id:"risk-name-filter",xtype:"intelcombobox",flex:1,store:Ext.create("Ext.data.Store",{fields:["Name"],data:getNameFilterOptions()}),displayField:"Name",value:"All",listeners:{select:function(combo,selected){filterName="All"==selected[0].data.Name?null:selected[0].data.Name,filterRisksRowsByFn(riskGridFilter)}}},{xtype:"container",width:5}]},{text:me.PortfolioItemTypes.slice(-1).pop(),dataIndex:"TopPortfolioItemName",width:100,resizable:!1,draggable:!1,editor:!1,sortable:!0,renderer:defaultRenderer,layout:"hbox",items:[{id:"risk-top-portfolioitem-filter",xtype:"intelfixedcombo",flex:1,store:Ext.create("Ext.data.Store",{fields:["PortfolioItemName"],data:getTopPortfolioItemFilterOptions()}),displayField:"PortfolioItemName",value:"All",listeners:{focus:function(combo){combo.expand()
},select:function(combo,selected){filterTopPortfolioItem="All"==selected[0].data.PortfolioItemName?null:selected[0].data.PortfolioItemName,filterRisksRowsByFn(riskGridFilter)}}},{xtype:"container",width:5}]},{text:"Team",dataIndex:"ProjectObjectID",flex:1,minWidth:100,editor:!1,resizable:!1,draggable:!1,sortable:!0,renderer:function(projectObjectID){return((me.ProjectsWithTeamMembers[projectObjectID]||{}).data||{}).Name||"?"},layout:"hbox",items:[{id:"risk-team-filter",xtype:"intelcombobox",flex:1,store:Ext.create("Ext.data.Store",{fields:["Team"],data:getTeamFilterOptions()}),displayField:"Team",value:"All",listeners:{select:function(combo,selected){filterTeam="All"==selected[0].data.Team?null:selected[0].data.Team,filterRisksRowsByFn(riskGridFilter)}}},{xtype:"container",width:5}]},{text:"Risk Description (If This...)",dataIndex:"Description",tdCls:"intel-editor-cell",flex:1,editor:"inteltextarea",resizable:!1,draggable:!1,sortable:!1,renderer:defaultRenderer},{text:"Impact (Then this...)",dataIndex:"Impact",tdCls:"intel-editor-cell",flex:1,resizable:!1,draggable:!1,sortable:!1,editor:"inteltextarea",renderer:defaultRenderer},{text:"Mitigation Plan",dataIndex:"MitigationPlan",tdCls:"intel-editor-cell",flex:1,resizable:!1,draggable:!1,sortable:!1,editor:"inteltextarea",renderer:defaultRenderer},{text:"Urgency",dataIndex:"Urgency",tdCls:"intel-editor-cell",width:90,editor:{xtype:"intelfixedcombo",store:Ext.create("Ext.data.Store",{fields:["Urgency"],data:[{Urgency:"Undefined"},{Urgency:"Hot"},{Urgency:"Watch"},{Urgency:"Simmer"}]}),displayField:"Urgency"},resizable:!1,draggable:!1,sortable:!0,renderer:function(val,meta){return meta.tdCls+="Hot"===val?" predecessor-hot-urgency-cell":"",val||"Undefined"},layout:"hbox",items:[{id:"risk-urgency-filter",xtype:"intelfixedcombo",flex:1,store:Ext.create("Ext.data.Store",{fields:["Urgency"],data:[{Urgency:"All"},{Urgency:"Undefined"},{Urgency:"Hot"},{Urgency:"Watch"},{Urgency:"Simmer"}]}),displayField:"Urgency",value:"All",listeners:{focus:function(combo){combo.expand()},select:function(combo,selected){filterUrgency="All"==selected[0].data.Urgency?null:selected[0].data.Urgency,filterRisksRowsByFn(riskGridFilter)}}},{xtype:"container",width:5}]},{text:"Status",dataIndex:"Status",tdCls:"intel-editor-cell",width:100,tooltip:"(ROAM)",tooltipType:"title",editor:{xtype:"intelfixedcombo",store:Ext.create("Ext.data.Store",{fields:["Status"],data:[{Status:"Undefined"},{Status:"Resolved"},{Status:"Owned"},{Status:"Accepted"},{Status:"Mitigated"}]}),displayField:"Status"},resizable:!1,draggable:!1,sortable:!0,renderer:function(val,meta){return meta.tdCls+="Undefined"===val?" risks-grid-error-cell":"",val||"-"},layout:"hbox",items:[{id:"risk-status-filter",xtype:"intelfixedcombo",flex:1,store:Ext.create("Ext.data.Store",{fields:["Status"],data:[{Status:"All"},{Status:"Undefined"},{Status:"Resolved"},{Status:"Owned"},{Status:"Accepted"},{Status:"Mitigated"}]}),displayField:"Status",value:"All",listeners:{focus:function(combo){combo.expand()},select:function(combo,selected){filterStatus="All"==selected[0].data.Status?null:selected[0].data.Status,filterRisksRowsByFn(riskGridFilter)}}},{xtype:"container",width:5}]},{text:"Contact",dataIndex:"Contact",tdCls:"intel-editor-cell",flex:1,editor:"inteltextarea",sortable:!1,resizable:!1,draggable:!1,renderer:defaultRenderer},{text:"Checkpoint",dataIndex:"Checkpoint",tdCls:"intel-editor-cell",width:90,resizable:!1,draggable:!1,editor:{xtype:"intelfixedcombo",width:80,store:Ext.create("Ext.data.Store",{model:"WorkweekDropdown",data:me.WorkweekData}),displayField:"Workweek",valueField:"DateVal"},sortable:!0,renderer:function(date){return date?"ww"+me._getWorkweek(date):"-"},layout:"hbox",items:[{id:"risk-checkpoint-filter",xtype:"intelfixedcombo",flex:1,store:Ext.create("Ext.data.Store",{model:"WorkweekDropdown",data:getCheckpointFilterOptions()}),displayField:"Workweek",valueField:"DateVal",value:"All",listeners:{focus:function(combo){combo.expand()},select:function(combo,selected){filterCheckpoint=0===selected[0].data.DateVal?null:selected[0].data.DateVal,filterRisksRowsByFn(riskGridFilter)}}},{xtype:"container",width:5}]},{text:"",width:24,resizable:!1,draggable:!1,renderer:function(value,meta,riskRecord,row,col){var realRiskData=me._spliceRiskFromList(riskRecord.data.RiskID,me.RisksParsedData.slice()),dirtyType=me._getDirtyType(riskRecord,realRiskData),clickFnName="Click"+riskRecord.id.replace(/\-/g,"z")+"Fn"+col;if("Edited"===dirtyType)return meta.tdAttr='title="Undo"',window[clickFnName]=function(){var realRiskData=me._spliceRiskFromList(riskRecord.data.RiskID,me.RisksParsedData.slice());riskRecord.beginEdit(),_.each(realRiskData,function(value,field){riskRecord.set(field,value)}),riskRecord.endEdit(),updateFilterOptions()},'<div class="intel-editor-cell" onclick="'+clickFnName+'()"><i class="fa fa-md fa-undo"></i></div>'}},{text:"",width:24,resizable:!1,draggable:!1,renderer:function(value,meta,riskRecord,row,col){var realRiskData=me._spliceRiskFromList(riskRecord.data.RiskID,me.RisksParsedData.slice()),dirtyType=me._getDirtyType(riskRecord,realRiskData),clickFnName="Click"+riskRecord.id.replace(/\-/g,"z")+"Fn"+col;if("New"===dirtyType||"Edited"===dirtyType)return meta.tdAttr='title="Save Risk"',window[clickFnName]=function(){return riskRecord.data.PortfolioItemFormattedID&&riskRecord.data.PortfolioItemName?riskRecord.data.Checkpoint?riskRecord.data.Description?riskRecord.data.Impact?riskRecord.data.Status?riskRecord.data.Contact?(me.RisksGrid.setLoading("Saving Risk"),me._enqueue(function(unlockFunc){var portfolioItemFormattedID=riskRecord.data.PortfolioItemFormattedID,newPortfolioItemRecord=me.PortfolioItemStore.findExactRecord("FormattedID",portfolioItemFormattedID),projectRecord=me.ProjectsWithTeamMembers[riskRecord.data.ProjectObjectID];return projectRecord?(Q(newPortfolioItemRecord.data.ObjectID!=riskRecord.data.PortfolioItemObjectID?me._loadPortfolioItemByOrdinal(newPortfolioItemRecord.data.ObjectID,0).then(function(portfolioItemRecord){newPortfolioItemRecord=portfolioItemRecord}):null).then(function(){return riskRecord.data.PortfolioItemObjectID?me._loadPortfolioItemByOrdinal(riskRecord.data.PortfolioItemObjectID,0):null}).then(function(oldPortfolioItemRecord){newPortfolioItemRecord=newPortfolioItemRecord||oldPortfolioItemRecord;var oldRealRiskData=me._getRealRiskData(oldPortfolioItemRecord,riskRecord.data.RiskID);return oldRealRiskData&&oldPortfolioItemRecord.data.ObjectID!==newPortfolioItemRecord.data.ObjectID?me._removeRisk(oldPortfolioItemRecord,oldRealRiskData,projectRecord,me.RisksParsedData):void 0}).then(function(){return me._addRisk(newPortfolioItemRecord,riskRecord.data,projectRecord,me.RisksParsedData)}).then(function(){riskRecord.beginEdit(),riskRecord.set("Edited",!1),riskRecord.set("PortfolioItemObjectID",newPortfolioItemRecord.data.ObjectID),riskRecord.endEdit()}).fail(function(reason){me._alert("ERROR:",reason||"")}).then(function(){unlockFunc(),me.RisksGrid.setLoading(!1),updateFilterOptions()}).done(),void 0):Q.reject("Invalid project ObjectID: "+riskRecord.data.ProjectObjectID)},"Queue-Main"),void 0):(me._alert("ERROR","You must set the Contact for this Risk"),void 0):(me._alert("ERROR","You must set the Status for this Risk"),void 0):(me._alert("ERROR","You must set the Impact for this Risk"),void 0):(me._alert("ERROR","You must set the Description for this Risk"),void 0):(me._alert("ERROR","You must set the Checkpoint for this Risk"),void 0):(me._alert("ERROR","You must set the "+me.PortfolioItemTypes[0]+" affected by this Risk"),void 0)},'<div class="intel-editor-cell" onclick="'+clickFnName+'()"><i class="fa fa-md fa-floppy-o"></i></div>'}}];me.RisksGrid=me.add({xtype:"rallygrid",cls:"risksdeps-grid risks-grid rally-grid",header:{layout:"hbox",items:[{xtype:"text",cls:"risksdeps-grid-header-text",width:200,text:me._getTrainName(me.TrainRecord)+" RISKS"},{xtype:"container",flex:1e3,layout:{type:"hbox",pack:"end"},items:[{xtype:"button",text:"Remove Filters",width:110,listeners:{click:removeFilters}}]}]},height:360,scroll:"vertical",columnCfgs:columnCfgs,plugins:["fastcellediting"],viewConfig:{xtype:"scrolltableview",stripeRows:!0,preserveScrollOnRefresh:!0,getRowClass:function(item){return riskGridFilter(item)?"":"risksdeps-hidden-grid-row"}},listeners:{sortchange:function(){filterRisksRowsByFn(riskGridFilter)},edit:function(editor,e){var grid=e.grid,risksRecord=e.record,field=e.field,value=e.value,originalValue=e.originalValue;if(value!==originalValue){if(!value&&"MitigationPlan"!=field)return risksRecord.set(field,originalValue),void 0;["Description","Impact","Contact","MitigationPlan"].indexOf(field)>-1&&(value=me._htmlEscape(value),risksRecord.set(field,value));var previousEdit=risksRecord.data.Edited;risksRecord.set("Edited",!0);var portfolioItemRecord;"PortfolioItemName"===field?(portfolioItemRecord=me.PortfolioItemStore.findExactRecord("Name",value),portfolioItemRecord?risksRecord.set("PortfolioItemFormattedID",portfolioItemRecord.data.FormattedID):(risksRecord.set("PortfolioItemName",originalValue),risksRecord.set("Edited",previousEdit))):"PortfolioItemFormattedID"===field&&(portfolioItemRecord=me.PortfolioItemStore.findExactRecord("FormattedID",value),portfolioItemRecord?risksRecord.set("PortfolioItemName",portfolioItemRecord.data.Name):(risksRecord.set("PortfolioItemFormattedID",originalValue),risksRecord.set("Edited",previousEdit))),updateFilterOptions()}}},disableSelection:!0,showRowActionsColumn:!1,showPagingToolbar:!1,enableEditing:!1,store:me.CustomRisksStore})},_loadDependenciesGrids:function(){function dependencySorter(o1,o2){return o1.data.DependencyID>o2.data.DependencyID?-1:1}function predecessorItemSorter(o1,o2){return o1.data.PredecessorItemID>o2.data.PredecessorItemID?-1:1}function predecessorGridFilter(predecessorRecord){if(filterPredUserStoryFormattedID&&predecessorRecord.data.UserStoryFormattedID!=filterPredUserStoryFormattedID)return!1;if(filterPredUserStoryName&&predecessorRecord.data.UserStoryName!=filterPredUserStoryName)return!1;if(filterOwningTeam&&((me.ProjectsWithTeamMembers[predecessorRecord.data.ProjectObjectID]||{}).data||{}).Name!=filterOwningTeam)return!1;if(filterTopPortfolioItem&&predecessorRecord.data.TopPortfolioItemName!=filterTopPortfolioItem)return!1;if(filterPredNeededBy&&1*me._roundDateDownToWeekStart(predecessorRecord.data.NeededBy)!=filterPredNeededBy)return!1;if(filterDisposition){if("Done"==filterDisposition&&predecessorRecord.data.Status!=filterDisposition)return!1;if("Not Done"==filterDisposition&&predecessorRecord.data.Status&&predecessorRecord.data.Status!=filterDisposition)return!1}return!0}function filterPredecessorRowsByFn(fn){_.each(me.CustomPredecessorStore.getRange(),function(item,index){fn(item)?me.PredecessorGrid.view.removeRowCls(index,"risksdeps-hidden-grid-row"):me.PredecessorGrid.view.addRowCls(index,"risksdeps-hidden-grid-row")})}function removePredecessorFilters(){filterPredUserStoryFormattedID=null,filterPredUserStoryName=null,filterOwningTeam=null,filterTopPortfolioItem=null,filterPredNeededBy=null,filterDisposition=null,filterPredecessorRowsByFn(function(){return!0}),Ext.getCmp("predecessor-us-formattedid-filter").setValue("All"),Ext.getCmp("predecessor-us-name-filter").setValue("All"),Ext.getCmp("predecessor-owning-team-filter").setValue("All"),Ext.getCmp("predecessor-top-portfolioitem-filter").setValue("All"),Ext.getCmp("predecessor-needed-by-filter").setValue("All"),Ext.getCmp("predecessor-status-filter").setValue("All")}function getPredecessorFormattedIDFilterOptions(){return[{FormattedID:"All"}].concat(_.map(_.sortBy(_.union(_.map(me.CustomPredecessorStore.getRange(),function(r){return r.data.UserStoryFormattedID})),function(f){return f}),function(f){return{FormattedID:f}}))}function getPredecessorNameFilterOptions(){return[{Name:"All"}].concat(_.map(_.sortBy(_.union(_.map(me.CustomPredecessorStore.getRange(),function(r){return r.data.UserStoryName})),function(f){return f}),function(n){return{Name:n}}))}function getTopPortfolioItemFilterOptions(){return[{PortfolioItemName:"All"}].concat(_.map(_.sortBy(_.union(_.values(me.PortfolioItemMap)),function(p){return p}),function(p){return{PortfolioItemName:p}}))}function getTeamFilterOptions(){return[{Team:"All"}].concat(_.map(_.sortBy(_.union(_.map(me.CustomPredecessorStore.getRange(),function(p){return((me.ProjectsWithTeamMembers[p.data.ProjectObjectID]||{}).data||{}).Name})),function(f){return f}),function(t){return{Team:t}}))}function getPredecessorNeededByFilterOptions(){return[{DateVal:0,Workweek:"All"}].concat(_.map(_.sortBy(_.union(_.map(me.CustomPredecessorStore.getRange(),function(r){return 1*me._roundDateDownToWeekStart(r.data.NeededBy)})),function(date){return date}),function(date){return{DateVal:date,Workweek:"ww"+me._getWorkweek(date)}}))}function updatePredecessorFilterOptions(){}var me=this,defaultRenderer=function(val){return val||"-"};me.UserStoryFIDStore=Ext.create("Ext.data.Store",{fields:["FormattedID"],data:_.map(me.UserStoriesInRelease,function(usr){return{FormattedID:usr.data.FormattedID}}),sorters:{property:"FormattedID"}}),me.UserStoryNameStore=Ext.create("Ext.data.Store",{fields:["Name"],data:_.map(me.UserStoriesInRelease,function(usr){return{Name:usr.data.Name}}),sorters:{property:"Name"}}),me.PrececessorItemStores={},me.PredecessorItemGrids={},me.CustomPredecessorStore=Ext.create("Intel.data.FastStore",{data:Ext.clone(me.DependenciesParsedData.Predecessors),autoSync:!0,model:"IntelPredecessorDependencyForTracking",limit:1/0,disableMetaChangeEvent:!0,proxy:{type:"fastsessionproxy",id:"IntelPredecessorDependencyProxy"+Math.random()},sorters:[dependencySorter],intelUpdate:function(){var predecessorStore=me.CustomPredecessorStore,realPredecessorsData=me.DependenciesParsedData.Predecessors.slice();predecessorStore.suspendEvents(!0),_.each(predecessorStore.getRange(),function(predecessorRecord){var dependencyID=predecessorRecord.data.DependencyID,realPredecessorData=me._spliceDependencyFromList(dependencyID,realPredecessorsData),dirtyType=me._getDirtyType(predecessorRecord,realPredecessorData),predecessorItemStore=me.PrececessorItemStores[dependencyID],predecessorItemGrid=me.PredecessorItemGrids[dependencyID],remoteChanged=!1;"New"===dirtyType||"Edited"===dirtyType||("Deleted"==dirtyType?(predecessorStore.remove(predecessorRecord),predecessorItemStore&&(me.PrececessorItemStores[dependencyID]=void 0),predecessorItemGrid&&(me.PredecessorItemGrids[dependencyID]=void 0)):_.isEqual(predecessorRecord.data.PredecessorItems,realPredecessorData.PredecessorItems)?(_.each(realPredecessorData,function(value,field){"PredecessorItems"===field||_.isEqual(predecessorRecord.data[field],value)||(remoteChanged=!0)}),remoteChanged&&(predecessorRecord.beginEdit(),_.each(realPredecessorData,function(value,field){"PredecessorItems"!==field&&predecessorRecord.set(field,value)}),predecessorRecord.endEdit())):(predecessorItemGrid&&(me.PredecessorItemGrids[dependencyID].destroy(),delete me.PredecessorItemGrids[dependencyID]),predecessorStore.remove(predecessorRecord),predecessorStore.add(Ext.create("IntelPredecessorDependencyForTracking",Ext.clone(realPredecessorData))),predecessorItemStore&&predecessorItemStore.intelUpdate())),predecessorRecord.data.PredecessorItems.length||(predecessorRecord.set("PredecessorItems",[me._newPredecessorItem()]),predecessorItemStore&&predecessorItemStore.intelUpdate())}),_.each(realPredecessorsData,function(realPredecessorData){predecessorStore.add(Ext.create("IntelPredecessorDependencyForTracking",Ext.clone(realPredecessorData)));var dependencyID=realPredecessorData.DependencyID,predecessorItemStore=me.PrececessorItemStores[dependencyID];predecessorItemStore&&predecessorItemStore.intelUpdate()}),predecessorStore.resumeEvents()}});var filterPredUserStoryFormattedID=null,filterPredUserStoryName=null,filterTopPortfolioItem=null,filterOwningTeam=null,filterPredNeededBy=null,filterDisposition=null,predecessorColumnCfgs=[{text:"#",dataIndex:"UserStoryFormattedID",width:90,resizable:!1,draggable:!1,sortable:!0,editor:!1,renderer:defaultRenderer,layout:"hbox",items:[{id:"predecessor-us-formattedid-filter",xtype:"intelcombobox",flex:1,store:Ext.create("Ext.data.Store",{fields:["FormattedID"],data:getPredecessorFormattedIDFilterOptions()}),displayField:"FormattedID",value:"All",listeners:{select:function(combo,selected){filterPredUserStoryFormattedID="All"==selected[0].data.FormattedID?null:selected[0].data.FormattedID,filterPredecessorRowsByFn(predecessorGridFilter)}}},{xtype:"container",width:5}]},{text:"UserStory",dataIndex:"UserStoryName",flex:1,resizable:!1,draggable:!1,sortable:!0,editor:!1,renderer:defaultRenderer,layout:"hbox",items:[{id:"predecessor-us-name-filter",xtype:"intelcombobox",flex:1,store:Ext.create("Ext.data.Store",{fields:["Name"],data:getPredecessorNameFilterOptions()}),displayField:"Name",value:"All",listeners:{select:function(combo,selected){filterPredUserStoryName="All"==selected[0].data.Name?null:selected[0].data.Name,filterPredecessorRowsByFn(predecessorGridFilter)}}},{xtype:"container",width:5}]},{text:me.PortfolioItemTypes.slice(-1).pop(),dataIndex:"TopPortfolioItemName",width:90,resizable:!1,draggable:!1,editor:!1,sortable:!0,renderer:defaultRenderer,layout:"hbox",items:[{id:"predecessor-top-portfolioitem-filter",xtype:"intelfixedcombo",flex:1,store:Ext.create("Ext.data.Store",{fields:["PortfolioItemName"],data:getTopPortfolioItemFilterOptions()}),displayField:"PortfolioItemName",value:"All",listeners:{focus:function(combo){combo.expand()},select:function(combo,selected){filterTopPortfolioItem="All"==selected[0].data.PortfolioItemName?null:selected[0].data.PortfolioItemName,filterPredecessorRowsByFn(predecessorGridFilter)}}},{xtype:"container",width:5}]},{text:"Owning Team",dataIndex:"ProjectObjectID",flex:2,minWidth:100,resizable:!1,draggable:!1,editor:!1,sortable:!0,renderer:function(projectObjectID){return((me.ProjectsWithTeamMembers[projectObjectID]||{}).data||{}).Name||"?"},layout:"hbox",items:[{id:"predecessor-owning-team-filter",xtype:"intelcombobox",flex:1,store:Ext.create("Ext.data.Store",{fields:["Team"],data:getTeamFilterOptions()}),displayField:"Team",value:"All",listeners:{select:function(combo,selected){filterOwningTeam="All"==selected[0].data.Team?null:selected[0].data.Team,filterPredecessorRowsByFn(predecessorGridFilter)}}},{xtype:"container",width:5}]},{text:"Dependency Description",dataIndex:"Description",flex:1,resizable:!1,draggable:!1,sortable:!1,editor:!1,renderer:defaultRenderer},{text:"Needed By",dataIndex:"NeededBy",width:90,resizable:!1,draggable:!1,sortable:!0,editor:!1,renderer:function(date){return date?"ww"+me._getWorkweek(date):"-"},layout:"hbox",items:[{id:"predecessor-needed-by-filter",xtype:"intelfixedcombo",flex:1,store:Ext.create("Ext.data.Store",{model:"WorkweekDropdown",data:getPredecessorNeededByFilterOptions()}),displayField:"Workweek",valueField:"DateVal",value:"All",listeners:{focus:function(combo){combo.expand()},select:function(combo,selected){filterPredNeededBy=0===selected[0].data.DateVal?null:selected[0].data.DateVal,filterPredecessorRowsByFn(predecessorGridFilter)}}},{xtype:"container",width:5}]},{text:"Teams Depended On",dataIndex:"DependencyID",xtype:"fastgridcolumn",html:'<div class="predecessor-items-grid-header" style="width:10px !important;"></div><div class="predecessor-items-grid-header" style="width:110px !important;">Team Name</div><div class="predecessor-items-grid-header" style="width:95px  !important;">Supported</div><div class="predecessor-items-grid-header" style="width:70px  !important;">#</div><div class="predecessor-items-grid-header" style="width:130px !important;">User Story</div>',width:450,resizable:!1,draggable:!1,sortable:!1,renderer:function(dependencyID){var predecessorStore=me.CustomPredecessorStore,predecessorRecord=predecessorStore.getAt(predecessorStore.findExact("DependencyID",dependencyID)),predecessorItems=predecessorRecord.data.PredecessorItems;if(me.PrececessorItemStores[dependencyID]||(me.PrececessorItemStores[dependencyID]=Ext.create("Intel.data.FastStore",{model:"IntelPredecessorItem",data:predecessorItems,autoSync:!0,limit:1/0,disableMetaChangeEvent:!0,proxy:{type:"fastsessionproxy",id:"PredecessorItem-"+dependencyID+"-proxy"+Math.random()},sorters:[predecessorItemSorter],intelUpdate:function(){var predecessorStore=me.CustomPredecessorStore,predecessorItemStore=me.PrececessorItemStores[dependencyID],predecessorItems=predecessorItemStore.getRange(),predecessorRecord=predecessorStore.getAt(predecessorStore.findExact("DependencyID",dependencyID)),realPredecessorItemsData=predecessorRecord.data.PredecessorItems.slice();if(predecessorItemStore.suspendEvents(!0),_.each(predecessorItems,function(predecessorItem){var realPredecessorItemData=_.find(realPredecessorItemsData,function(realPredecessorItemData){return realPredecessorItemData.PredecessorItemID===predecessorItem.data.PredecessorItemID});realPredecessorItemData?(realPredecessorItemsData=_.filter(realPredecessorItemsData,function(realPredecessorItemData2){return realPredecessorItemData.PredecessorItemID!==realPredecessorItemData2.PredecessorItemID}),_.each(realPredecessorItemData,function(value,field){return _.isEqual(predecessorItem.data[field],value)?void 0:(predecessorItemStore.remove(predecessorItem),predecessorItemStore.add(Ext.create("IntelPredecessorItem",Ext.clone(realPredecessorItemData))),!1)})):predecessorItemStore.remove(predecessorItem)}),_.each(realPredecessorItemsData,function(realPredecessorItemData){predecessorItemStore.add(Ext.create("IntelPredecessorItem",realPredecessorItemData))}),0===predecessorItemStore.getRange().length){var newItem=me._newPredecessorItem();predecessorItemStore.add(Ext.create("IntelPredecessorItem",newItem)),predecessorRecord.data.PredecessorItems.push(newItem)}predecessorItemStore.resumeEvents()}})),me.PredecessorItemGrids[dependencyID])return me.PredecessorItemGrids[dependencyID];var swallowEventHandler={element:"el",fn:function(a){a.stopPropagation()}},predecessorItemColumnCfgs=[{dataIndex:"PredecessorProjectObjectID",width:115,resizable:!1,editor:!1,renderer:function(val,meta){var projectRecord=me.ProjectsWithTeamMembers[val];return val&&projectRecord?projectRecord.data.Name:"-"}},{dataIndex:"Supported",width:80,resizable:!1,editor:!1,renderer:function(val,meta){return"No"==val?meta.tdCls="predecessor-item-not-supported-cell":"Yes"==val&&(meta.tdCls="predecessor-item-supported-cell"),val}},{dataIndex:"PredecessorUserStoryObjectID",width:75,resizable:!1,editor:!1,renderer:function(userStoryObjectID,meta,predecessorItemRecord){if(predecessorItemRecord.data.Assigned){var userStory=me.DependenciesHydratedUserStories[userStoryObjectID];return userStory?userStory.data.FormattedID:"?"}return"-"}},{dataIndex:"PredecessorUserStoryObjectID",width:140,resizable:!1,editor:!1,renderer:function(userStoryObjectID,meta,predecessorItemRecord){if(predecessorItemRecord.data.Assigned){var userStory=me.DependenciesHydratedUserStories[userStoryObjectID];return userStory?userStory.data.Name:"?"}return"-"}}];return{xtype:"rallygrid",cls:"risksdeps-grid predecessor-items-grid rally-grid",plugins:["fastcellediting"],viewConfig:{stripeRows:!1},width:420,manageHeight:!1,columnCfgs:predecessorItemColumnCfgs,listeners:{mousedown:swallowEventHandler,mousemove:swallowEventHandler,mouseout:swallowEventHandler,mouseover:swallowEventHandler,mouseup:swallowEventHandler,mousewheel:swallowEventHandler,scroll:swallowEventHandler,click:swallowEventHandler,dblclick:swallowEventHandler,contextmenu:swallowEventHandler,render:function(){me.PredecessorItemGrids[dependencyID]=this},selectionchange:function(){this.getSelectionModel().deselectAll()}},rowLines:!1,disableSelection:!0,scroll:!1,hideHeaders:!0,showRowActionsColumn:!1,showPagingToolbar:!1,enableEditing:!1,store:me.PrececessorItemStores[dependencyID]}}},{dataIndex:"Status",width:90,resizable:!1,draggable:!1,sortable:!1,tdCls:"intel-editor-cell",text:"Disposition",editor:{xtype:"intelfixedcombo",store:Ext.create("Ext.data.Store",{fields:["Status"],data:[{Status:"Done"},{Status:"Not Done"}]}),displayField:"Status"},renderer:function(val,meta){return meta.tdCls+="Done"===val?" predecessor-supported-cell":" predecessor-not-supported-cell",val||"Not Done"},layout:"hbox",items:[{id:"predecessor-status-filter",xtype:"intelfixedcombo",flex:1,store:Ext.create("Ext.data.Store",{fields:["Status"],data:[{Status:"All"},{Status:"Done"},{Status:"Not Done"}]}),displayField:"Status",value:"All",listeners:{focus:function(combo){combo.expand()},select:function(combo,selected){filterDisposition="All"===selected[0].data.Status?null:selected[0].data.Status,filterPredecessorRowsByFn(predecessorGridFilter)}}},{xtype:"container",width:5}]}];me.PredecessorGrid=me.add({xtype:"rallygrid",cls:"risksdeps-grid predecessors-grid rally-grid",header:{layout:"hbox",items:[{xtype:"text",cls:"risksdeps-grid-header-text",width:400,text:me._getTrainName(me.TrainRecord)+" DEPENDENCIES"},{xtype:"container",flex:1e3,layout:{type:"hbox",pack:"end"},items:[{xtype:"button",text:"Remove Filters",width:110,listeners:{click:removePredecessorFilters}}]}]},height:400,scroll:"vertical",columnCfgs:predecessorColumnCfgs,plugins:["fastcellediting"],viewConfig:{xtype:"scrolltableview",stripeRows:!0,preserveScrollOnRefresh:!0,getRowClass:function(predecessorRecord){return predecessorGridFilter(predecessorRecord)?void 0:"risksdeps-hidden-grid-row"}},listeners:{sortchange:function(){filterPredecessorRowsByFn(predecessorGridFilter)},edit:function(editor,e){var predecessorRecord=e.record,predecessorData=predecessorRecord.data,field=e.field,value=e.value,originalValue=e.originalValue;if(value!==originalValue){if(!value)return predecessorRecord.set(field,originalValue),void 0;var previousEdit=predecessorRecord.data.Edited;predecessorRecord.set("Edited",!0),me.PredecessorGrid.setLoading("Saving"),me._enqueue(function(unlockFunc){me._getOldAndNewUserStoryRecords(predecessorData,me.UserStoryStore.getRange()).then(function(records){var userStoryRecord=records[1];return me._addPredecessor(userStoryRecord,predecessorData,null,me.DependenciesParsedData)}).then(function(){predecessorRecord.set("Edited",!1)}).fail(function(reason){me._alert("ERROR:",reason)}).then(function(){me.PredecessorGrid.setLoading(!1),updatePredecessorFilterOptions(),unlockFunc()}).done()})}}},disableSelection:!0,showRowActionsColumn:!1,showPagingToolbar:!1,enableEditing:!1,store:me.CustomPredecessorStore})}})})();

            Rally.launchApp('RisksDepsTracking', {
                name:"Risks and Deps Tracking",
	            parentRepos:""
            });

        });
    </script>

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"/>

    <style type="text/css">
        .x-grid-cell.intel-editor-cell *,.x4-grid-cell.intel-editor-cell *,.intel-editor-cell{cursor:pointer !important}.fa.fa-md{font-size:1.05rem;line-height:.75em;vertical-align:-15%}
    </style>
    <style type="text/css">
        .x-grid-body .x-grid-row .risks-grid-error-cell.x-grid-cell{background-color:rgba(255,0,0,0.15) !important}.predecessor-items-grid .x-grid-body{background-color:rgba(0,0,0,0) !important;border-top:0 !important}.predecessor-items-grid-header{display:inline-block !important;line-height:100% !important;font-weight:500 !important}.x-grid-body .x-grid-row .predecessor-item-not-supported-cell.x-grid-cell,.x-grid-body .x-grid-row .predecessor-not-supported-cell.x-grid-cell,.x-grid-body .x-grid-row .successor-not-supported-cell.x-grid-cell{background-color:rgba(255,0,0,0.15) !important}.x-grid-body .x-grid-row-selected .predecessor-item-not-supported-cell.x-grid-cell,.x-grid-body .x-grid-row-selected .predecessor-not-supported-cell.x-grid-cell,.x-grid-body .x-grid-row-selected .successor-not-supported-cell.x-grid-cell{background-color:rgba(255,0,0,0.25) !important}.x-grid-body .x-grid-row .predecessor-item-supported-cell.x-grid-cell,.x-grid-body .x-grid-row .predecessor-supported-cell.x-grid-cell,.x-grid-body .x-grid-row .successor-supported-cell.x-grid-cell{background-color:rgba(0,255,0,0.15) !important}.x-grid-body .x-grid-row-selected .predecessor-item-supported-cell.x-grid-cell,.x-grid-body .x-grid-row-selected .predecessor-supported-cell.x-grid-cell,.x-grid-body .x-grid-row-selected .successor-supported-cell.x-grid-cell{background-color:rgba(0,255,0,0.25) !important}.duplicates-modal .grid-group-header{text-decoration:underline;padding-left:10px;font-size:1.25rem}.duplicates-modal .done-button{margin:10px 0 10px 10px}.duplicates-modal .x-grid-row-selected .x-grid-cell,.duplicates-modal .x-grid-row-over .x-grid-cell{background-color:rgba(0,0,0,0) !important}.duplicates-modal .duplicate-risks-grid,.duplicates-modal .duplicate-predecessors-grid,.duplicates-modal .duplicate-successors-grid{margin:10px 20px 10px 20px}.duplicates-modal .x-grid-row-checker{background-image:url(https://rally1.rallydev.com/apps/2.0rc3/rui/resources/css/images/form/radio.gif) !important}
    </style>
    <style type="text/css">
        .x-grid-cell.manager-expected-cell{background-image:-o-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:-moz-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:-webkit-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:-ms-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:linear-gradient(to right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-size:100% 30px;background-repeat:no-repeat}.x-grid-cell.manager-expected-cell-small{background-image:-o-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:-moz-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:-webkit-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:-ms-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:linear-gradient(to right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-size:100% 20px;background-repeat:no-repeat}.x-grid-cell.manager-comment-cell-small{background-image:-o-linear-gradient(left top, rgba(0,0,0,0) 75%, #4c4cff 75%) !important;background-image:-moz-linear-gradient(left top, rgba(0,0,0,0) 75%, #4c4cff 75%) !important;background-image:-webkit-linear-gradient(left top, rgba(0,0,0,0) 75%, #4c4cff 75%) !important;background-image:-ms-linear-gradient(left top, rgba(0,0,0,0) 75%, #4c4cff 75%) !important;background-image:linear-gradient(to left top, rgba(0,0,0,0) 75%, #4c4cff 75%) !important;background-size:100% 20px;background-repeat:no-repeat}.x-grid-cell.manager-expected-comment-cell-small{background-image:-o-linear-gradient(left top, rgba(0,0,0,0) 75%, #4c4cff 75%),-o-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:-moz-linear-gradient(left top, rgba(0,0,0,0) 75%, #4c4cff 75%),-moz-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:-webkit-linear-gradient(left top, rgba(0,0,0,0) 75%, #4c4cff 75%),-webkit-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:-ms-linear-gradient(left top, rgba(0,0,0,0) 75%, #4c4cff 75%),-ms-linear-gradient(right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-image:linear-gradient(to left top, rgba(0,0,0,0) 75%, #4c4cff 75%),linear-gradient(to right top, rgba(0,0,0,0) 75%, #fbff00 75%) !important;background-size:100% 20px;background-repeat:no-repeat}.x-grid-cell.intel-team-commits-RED{background-color:rgba(255,0,0,0.5) !important}.x-grid-row-selected .x-grid-cell.intel-team-commits-RED,.x-grid-row-over .x-grid-cell.intel-team-commits-RED{background-color:rgba(255,0,0,0.7) !important}.x-grid-cell.intel-team-commits-GREEN{background-color:rgba(0,255,0,0.5) !important}.x-grid-row-selected .x-grid-cell.intel-team-commits-GREEN,.x-grid-row-over .x-grid-cell.intel-team-commits-GREEN{background-color:rgba(0,255,0,0.7) !important}.x-grid-cell.intel-team-commits-GREY{background-color:rgba(183,183,183,0.5) !important}.x-grid-row-selected .x-grid-cell.intel-team-commits-GREY,.x-grid-row-over .x-grid-cell.intel-team-commits-GREY{background-color:rgba(183,183,183,0.7) !important}
    </style>
    <style type="text/css">
        .risksdeps-grid-header-text{font-size:13px !important}.risksdeps-hidden-grid-row{display:none !important}#navbar{padding:0 10px 0 10px}#releasePicker{margin:4px 0 0 0}#manualRefreshButton{margin:5px 0 0 5px}.risks-grid{margin:10px 10px 0px 10px}.predecessors-grid{margin:40px 10px 0px 10px}.x-grid-body .x-grid-row .predecessor-hot-urgency-cell.x-grid-cell{background-color:rgba(255,0,0,0.15) !important}.x-grid-body .x-grid-row-selected .predecessor-hot-urgency-cell.x-grid-cell{background-color:rgba(255,0,0,0.25) !important}
    </style>
</head>
<body>
</body>
</html>
